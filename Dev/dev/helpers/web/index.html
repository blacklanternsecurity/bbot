
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/Dev/dev/helpers/web/" rel="canonical"/>
<link href="../misc/" rel="prev"/>
<link href="../wordcloud/" rel="next"/>
<link href="../../../favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.33" name="generator"/>
<title>Web - BBOT Docs</title>
<link href="../../../assets/stylesheets/main.3cba04c6.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.9ftiaj0v.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#web">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Web
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
  User Manual

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../">
          
  
  Developer Manual

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    User Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_2" id="__nav_1_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Presets
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_2">
<span class="md-nav__icon md-icon"></span>
            Presets
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/presets/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/presets_list/">
<span class="md-ellipsis">
    List of Presets
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribution/">
<span class="md-ellipsis">
    Contribution
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Developer Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Developer Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Development Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dev_environment/">
<span class="md-ellipsis">
    Setting Up a Dev Environment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/">
<span class="md-ellipsis">
    BBOT Internal Architecture
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../module_howto/">
<span class="md-ellipsis">
    How to Write a BBOT Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tests/">
<span class="md-ellipsis">
    Unit Tests
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../discord_bot/">
<span class="md-ellipsis">
    Discord Bot Example
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
<span class="md-ellipsis">
    Code Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanner/">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../presets/">
<span class="md-ellipsis">
    Presets
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../core/">
<span class="md-ellipsis">
    BBOTCore
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/">
<span class="md-ellipsis">
    Engine
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_7_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7_8" id="__nav_2_7_8_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_7_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_7_8">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactsh/">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../misc/">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="web">Web</h1>
<p>These are helpers for making various web requests.</p>
<p>Note that these helpers can be invoked directly from <code>self.helpers</code>, e.g.:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span><span style="color: #a5d6ff">"https://www.evilcorp.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h1 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper">
<span class="doc doc-object-name doc-class-name">WebHelper</span>
</h1>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="bbot.core.engine.EngineClient" href="../../engine/#bbot.core.engine.EngineClient">EngineClient</a></code></p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">460</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">565</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">586</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">587</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">588</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">589</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">590</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">591</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">609</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">class</span> <span style="color: #f0883e; font-weight: bold">WebHelper</span><span style="color: #e6edf3">(EngineClient):</span>

    <span style="color: #e6edf3">SERVER_CLASS</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">HTTPEngine</span>
    <span style="color: #e6edf3">ERROR_CLASS</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">WebError</span>

<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Main utility class for managing HTTP operations in BBOT. It serves as a wrapper around the BBOTAsyncClient,</span>
<span style="color: #a5d6ff">    which itself is a subclass of httpx.AsyncClient. The class provides functionalities to make HTTP requests,</span>
<span style="color: #a5d6ff">    download files, and handle cached wordlists.</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        parent_helper (object): The parent helper object containing scan configurations.</span>
<span style="color: #a5d6ff">        http_debug (bool): Flag to indicate whether HTTP debugging is enabled.</span>
<span style="color: #a5d6ff">        ssl_verify (bool): Flag to indicate whether SSL verification is enabled.</span>
<span style="color: #a5d6ff">        web_client (BBOTAsyncClient): An instance of BBOTAsyncClient for making HTTP requests.</span>
<span style="color: #a5d6ff">        client_only_options (tuple): A tuple of options only applicable to the web client.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        Basic web request:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; response = await self.helpers.request("https://www.evilcorp.com")</span>

<span style="color: #a5d6ff">        Download file:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filename = await self.helpers.download("https://www.evilcorp.com/passwords.docx")</span>

<span style="color: #a5d6ff">        Download wordlist (cached for 30 days by default):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filename = await self.helpers.wordlist("https://www.evilcorp.com/wordlist.txt")</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">parent_helper):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_helper</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"web"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_depth"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_clients</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ssl_verify</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"ssl_verify"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">engine_debug</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"engine"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"debug"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">super()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(</span>
            <span style="color: #e6edf3">server_kwargs</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"config"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config,</span> <span style="color: #a5d6ff">"target"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">radix_only},</span>
            <span style="color: #e6edf3">debug</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">engine_debug,</span>
        <span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">AsyncClient</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #8b949e; font-style: italic"># cache by retries to prevent unwanted accumulation of clients</span>
        <span style="color: #8b949e; font-style: italic"># (they are not garbage-collected)</span>
        <span style="color: #e6edf3">retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_clients[retries]</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.client</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">BBOTAsyncClient</span>

            <span style="color: #e6edf3">client</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BBOTAsyncClient</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">from_config(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">persist_cookies</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_clients[client</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">retries]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">client</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">client</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Asynchronous function for making HTTP requests, intended to be the most basic web request function</span>
<span style="color: #a5d6ff">        used widely across BBOT and within this helper class. Handles various exceptions and timeouts</span>
<span style="color: #a5d6ff">        that might occur during the request.</span>

<span style="color: #a5d6ff">        This function automatically respects the scan's global timeout, proxy, headers, etc.</span>
<span style="color: #a5d6ff">        Headers you specify will be merged with the scan's. Your arguments take ultimate precedence,</span>
<span style="color: #a5d6ff">        meaning you can override the scan's values if you want.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            url (str): The URL to send the request to.</span>
<span style="color: #a5d6ff">            method (str, optional): The HTTP method to use for the request. Defaults to 'GET'.</span>
<span style="color: #a5d6ff">            headers (dict, optional): Dictionary of HTTP headers to send with the request.</span>
<span style="color: #a5d6ff">            params (dict, optional): Dictionary, list of tuples, or bytes to send in the query string.</span>
<span style="color: #a5d6ff">            cookies (dict, optional): Dictionary or CookieJar object containing cookies.</span>
<span style="color: #a5d6ff">            json (Any, optional): A JSON serializable Python object to send in the body.</span>
<span style="color: #a5d6ff">            data (dict, optional): Dictionary, list of tuples, or bytes to send in the body.</span>
<span style="color: #a5d6ff">            files (dict, optional): Dictionary of 'name': file-like-objects for multipart encoding upload.</span>
<span style="color: #a5d6ff">            auth (tuple, optional): Auth tuple to enable Basic/Digest/Custom HTTP auth.</span>
<span style="color: #a5d6ff">            timeout (float, optional): The maximum time to wait for the request to complete.</span>
<span style="color: #a5d6ff">            proxies (dict, optional): Dictionary mapping protocol schemes to proxy URLs.</span>
<span style="color: #a5d6ff">            allow_redirects (bool, optional): Enables or disables redirection. Defaults to None.</span>
<span style="color: #a5d6ff">            stream (bool, optional): Enables or disables response streaming.</span>
<span style="color: #a5d6ff">            raise_error (bool, optional): Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</span>
<span style="color: #a5d6ff">            client (httpx.AsyncClient, optional): A specific httpx.AsyncClient to use for the request. Defaults to self.web_client.</span>
<span style="color: #a5d6ff">            cache_for (int, optional): Time in seconds to cache the request. Not used currently. Defaults to None.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            httpx.TimeoutException: If the request times out.</span>
<span style="color: #a5d6ff">            httpx.ConnectError: If the connection fails.</span>
<span style="color: #a5d6ff">            httpx.RequestError: For other request-related errors.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            httpx.Response or None: The HTTP response object returned by the httpx library.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; response = await self.helpers.request("https://www.evilcorp.com")</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; response = await self.helpers.request("https://api.evilcorp.com/", method="POST", data="stuff")</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            If the web request fails, it will return None unless `raise_error` is `True`.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"request"</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">urls,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Given a list of URLs, request them in parallel and yield responses as they come in.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            urls (list[str]): List of URLs to visit</span>
<span style="color: #a5d6ff">            *args: Positional arguments to pass through to httpx</span>
<span style="color: #a5d6ff">            **kwargs: Keyword arguments to pass through to httpx</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; async for url, response in self.helpers.request_batch(urls, headers={"X-Test": "Test"}):</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     if response is not None and response.status_code == 200:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;         self.hugesuccess(response)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"request_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">urls,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
                <span style="color: #ff7b72">break</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request_custom_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">urls_and_kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Make web requests in parallel with custom options for each request. Yield responses as they come in.</span>

<span style="color: #a5d6ff">        Similar to `request_batch` except it allows individual arguments for each URL.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            urls_and_kwargs (list[tuple]): List of tuples in the format: (url, kwargs, custom_tracker)</span>
<span style="color: #a5d6ff">                where custom_tracker is an optional value for your own internal use. You may use it to</span>
<span style="color: #a5d6ff">                help correlate requests, etc.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; urls_and_kwargs = [</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     ("http://evilcorp.com/1", {"method": "GET"}, "request-1"),</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     ("http://evilcorp.com/2", {"method": "POST"}, "request-2"),</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; ]</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; async for url, kwargs, custom_tracker, response in self.helpers.request_custom_batch(</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     urls_and_kwargs</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; ):</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     if response is not None and response.status_code == 200:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;         self.hugesuccess(response)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"request_custom_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">urls_and_kwargs)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
                <span style="color: #ff7b72">break</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">download</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Asynchronous function for downloading files from a given URL. Supports caching with an optional</span>
<span style="color: #a5d6ff">        time period in hours via the "cache_hrs" keyword argument. In case of successful download,</span>
<span style="color: #a5d6ff">        returns the full path of the saved filename. If the download fails, returns None.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            url (str): The URL of the file to download.</span>
<span style="color: #a5d6ff">            filename (str, optional): The filename to save the downloaded file as.</span>
<span style="color: #a5d6ff">                If not provided, will generate based on URL.</span>
<span style="color: #a5d6ff">            max_size (str or int): Maximum filesize as a string ("5MB") or integer in bytes.</span>
<span style="color: #a5d6ff">            cache_hrs (float, optional): The number of hours to cache the downloaded file.</span>
<span style="color: #a5d6ff">                A negative value disables caching. Defaults to -1.</span>
<span style="color: #a5d6ff">            method (str, optional): The HTTP method to use for the request, defaults to 'GET'.</span>
<span style="color: #a5d6ff">            raise_error (bool, optional): Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</span>
<span style="color: #a5d6ff">            **kwargs: Additional keyword arguments to pass to the httpx request.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            Path or None: The full path of the downloaded file as a Path object if successful, otherwise None.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; filepath = await self.helpers.download("https://www.evilcorp.com/passwords.docx", cache_hrs=24)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"filename"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(url))</span>
        <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">truncate_filename(Path(filename)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve())</span>
        <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"filename"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filename</span>
        <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"max_size"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">human_to_bytes(max_size)</span>
            <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"max_size"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max_size</span>
        <span style="color: #e6edf3">cache_hrs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">float(kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"cache_hrs"</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">cache_hrs</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_cached(url):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">} is cached at {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(url)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"download"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">success:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filename</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">wordlist</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">path,</span> <span style="color: #e6edf3">lines</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Asynchronous function for retrieving wordlists, either from a local path or a URL.</span>
<span style="color: #a5d6ff">        Allows for optional line-based truncation and caching. Returns the full path of the wordlist</span>
<span style="color: #a5d6ff">        file or a truncated version of it.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            path (str): The local or remote path of the wordlist.</span>
<span style="color: #a5d6ff">            lines (int, optional): Number of lines to read from the wordlist.</span>
<span style="color: #a5d6ff">                If specified, will return a truncated wordlist with this many lines.</span>
<span style="color: #a5d6ff">            cache_hrs (float, optional): Number of hours to cache the downloaded wordlist.</span>
<span style="color: #a5d6ff">                Defaults to 720 hours (30 days) for remote wordlists.</span>
<span style="color: #a5d6ff">            **kwargs: Additional keyword arguments to pass to the 'download' function for remote wordlists.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            Path: The full path of the wordlist (or its truncated version) as a Path object.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            WordlistError: If the path is invalid or the wordlist could not be retrieved or found.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            Fetching full wordlist</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; wordlist_path = await self.helpers.wordlist("https://www.evilcorp.com/wordlist.txt")</span>

<span style="color: #a5d6ff">            Fetching and truncating to the first 100 lines</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; wordlist_path = await self.helpers.wordlist("/root/rockyou.txt", lines=100)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">path:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid wordlist: {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"cache_hrs"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
            <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"cache_hrs"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">720</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_url(path):</span>
            <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">download(str(path),</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unable to retrieve wordlist from {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(path)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file():</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unable to find wordlist at {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">lines</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filename</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">lines</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(lines)</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(filename)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
                <span style="color: #e6edf3">read_lines</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">readlines()</span>
            <span style="color: #e6edf3">cache_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">lines</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">truncated_filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(cache_key)</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(truncated_filename,</span> <span style="color: #a5d6ff">"w"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">read_lines[:lines]:</span>
                    <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">write(line)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">truncated_filename</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">api_page_iter</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">url,</span> <span style="color: #e6edf3">page_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">next_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">requests_kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        An asynchronous generator function for iterating through paginated API data.</span>

<span style="color: #a5d6ff">        This function continuously makes requests to a specified API URL, incrementing the page number</span>
<span style="color: #a5d6ff">        or applying a custom pagination function, and yields the received data one page at a time.</span>
<span style="color: #a5d6ff">        It is well-suited for APIs that provide paginated results.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            url (str): The initial API URL. Can contain placeholders for 'page', 'page_size', and 'offset'.</span>
<span style="color: #a5d6ff">            page_size (int, optional): The number of items per page. Defaults to 100.</span>
<span style="color: #a5d6ff">            json (bool, optional): If True, attempts to deserialize the response content to a JSON object. Defaults to True.</span>
<span style="color: #a5d6ff">            next_key (callable, optional): A function that takes the last page's data and returns the URL for the next page. Defaults to None.</span>
<span style="color: #a5d6ff">            **requests_kwargs: Arbitrary keyword arguments that will be forwarded to the HTTP request function.</span>

<span style="color: #a5d6ff">        Yields:</span>
<span style="color: #a5d6ff">            dict or httpx.Response: If 'json' is True, yields a dictionary containing the parsed JSON data. Otherwise, yields the raw HTTP response.</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            The loop will continue indefinitely unless manually stopped. Make sure to break out of the loop once the last page has been received.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; agen = api_page_iter('https://api.example.com/data?page={page}&amp;page_size={page_size}')</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; try:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     async for page in agen:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;         subdomains = page["subdomains"]</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;         self.hugesuccess(subdomains)</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;         if not subdomains:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;             break</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; finally:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt;     agen.aclose()</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">page</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">1</span>
        <span style="color: #e6edf3">offset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
        <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">callable(next_key):</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">new_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">next_key(result)</span>
                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to extract next page of results from {</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">new_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format(page</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">page,</span> <span style="color: #e6edf3">page_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">page_size,</span> <span style="color: #e6edf3">offset</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">offset)</span>
            <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(new_url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">requests_kwargs)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"api_page_iter() got no response for {</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">json:</span>
                    <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">result</span>
            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Error in api_page_iter() for url: "{</span><span style="color: #e6edf3">new_url</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">offset</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">page_size</span>
                <span style="color: #e6edf3">page</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">1</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">curl</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        An asynchronous function that runs a cURL command with specified arguments and options.</span>

<span style="color: #a5d6ff">        This function constructs and executes a cURL command based on the provided parameters.</span>
<span style="color: #a5d6ff">        It offers support for various cURL options such as headers, post data, and cookies.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            *args: Variable length argument list for positional arguments. Unused in this function.</span>
<span style="color: #a5d6ff">            url (str): The URL for the cURL request. Mandatory.</span>
<span style="color: #a5d6ff">            raw_path (bool, optional): If True, activates '--path-as-is' in cURL. Defaults to False.</span>
<span style="color: #a5d6ff">            headers (dict, optional): A dictionary of HTTP headers to include in the request.</span>
<span style="color: #a5d6ff">            ignore_bbot_global_settings (bool, optional): If True, ignores the global settings of BBOT. Defaults to False.</span>
<span style="color: #a5d6ff">            post_data (dict, optional): A dictionary containing data to be sent in the request body.</span>
<span style="color: #a5d6ff">            method (str, optional): The HTTP method to use for the request (e.g., 'GET', 'POST').</span>
<span style="color: #a5d6ff">            cookies (dict, optional): A dictionary of cookies to include in the request.</span>
<span style="color: #a5d6ff">            path_override (str, optional): Overrides the request-target to use in the HTTP request line.</span>
<span style="color: #a5d6ff">            head_mode (bool, optional): If True, includes '-I' to fetch headers only. Defaults to None.</span>
<span style="color: #a5d6ff">            raw_body (str, optional): Raw string to be sent in the body of the request.</span>
<span style="color: #a5d6ff">            **kwargs: Arbitrary keyword arguments that will be forwarded to the HTTP request function.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            str: The output of the cURL command.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            CurlError: If 'url' is not supplied.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; output = await curl(url="https://example.com", headers={"X-Header": "Wat"})</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; print(output)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">url:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">CurlError(</span><span style="color: #a5d6ff">"No URL supplied to CURL helper"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">curl_command</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"curl"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">url,</span> <span style="color: #a5d6ff">"-s"</span><span style="color: #e6edf3">]</span>

        <span style="color: #e6edf3">raw_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"raw_path"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raw_path:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"--path-as-is"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># respect global ssl verify settings</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ssl_verify</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-k"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>

        <span style="color: #e6edf3">ignore_bbot_global_settings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"ignore_bbot_global_settings"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ignore_bbot_global_settings:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"ignore_bbot_global_settings enabled. Global settings will not be applied"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">http_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">user_agent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"user_agent"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"BBOT"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"User-Agent"</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">headers:</span>
                <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"User-Agent"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">user_agent</span>

            <span style="color: #8b949e; font-style: italic"># only add custom headers if the URL is in-scope</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_scope(url):</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">hk,</span> <span style="color: #e6edf3">hv</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                    <span style="color: #e6edf3">headers[hk]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hv</span>

            <span style="color: #8b949e; font-style: italic"># add the timeout</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"timeout"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
                <span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">http_timeout</span>

            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-m"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(str(timeout))</span>

        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(v,</span> <span style="color: #e6edf3">list):</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">v:</span>
                    <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-H"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">x</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-H"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">post_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"post_data"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(post_data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items())</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-d"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">post_data_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">post_data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">post_data_str</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"&amp;{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}={</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(post_data_str</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lstrip(</span><span style="color: #a5d6ff">"&amp;"</span><span style="color: #e6edf3">))</span>

        <span style="color: #e6edf3">method</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">method:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-X"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(method)</span>

        <span style="color: #e6edf3">cookies</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"cookies"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">cookies:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-b"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">cookies_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">cookies</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">cookies_str</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}={</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}; "</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'{</span><span style="color: #e6edf3">cookies_str</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip(</span><span style="color: #a5d6ff">" "</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}'</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">path_override</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"path_override"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">path_override:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"--request-target"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">path_override</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">head_mode</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"head_mode"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">head_mode:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-I"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">raw_body</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"raw_body"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raw_body:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-d"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(raw_body)</span>

        <span style="color: #e6edf3">output</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(curl_command))</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stdout</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">output</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">beautifulsoup</span><span style="color: #e6edf3">(</span>
        <span style="color: #e6edf3">self,</span>
        <span style="color: #e6edf3">markup,</span>
        <span style="color: #e6edf3">features</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"html.parser"</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">builder</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">parse_only</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">from_encoding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">exclude_encodings</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">element_classes</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs,</span>
    <span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Naviate, Search, Modify, Parse, or PrettyPrint HTML Content.</span>
<span style="color: #a5d6ff">        More information at https://beautiful-soup-4.readthedocs.io/en/latest/</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            markup: A string or a file-like object representing markup to be parsed.</span>
<span style="color: #a5d6ff">            features: Desirable features of the parser to be used.</span>
<span style="color: #a5d6ff">                This may be the name of a specific parser ("lxml",</span>
<span style="color: #a5d6ff">                "lxml-xml", "html.parser", or "html5lib") or it may be</span>
<span style="color: #a5d6ff">                the type of markup to be used ("html", "html5", "xml").</span>
<span style="color: #a5d6ff">                Defaults to 'html.parser'.</span>
<span style="color: #a5d6ff">            builder: A TreeBuilder subclass to instantiate (or instance to use)</span>
<span style="color: #a5d6ff">                instead of looking one up based on `features`.</span>
<span style="color: #a5d6ff">            parse_only: A SoupStrainer. Only parts of the document</span>
<span style="color: #a5d6ff">                matching the SoupStrainer will be considered.</span>
<span style="color: #a5d6ff">            from_encoding: A string indicating the encoding of the</span>
<span style="color: #a5d6ff">                document to be parsed.</span>
<span style="color: #a5d6ff">            exclude_encodings = A list of strings indicating</span>
<span style="color: #a5d6ff">                encodings known to be wrong.</span>
<span style="color: #a5d6ff">            element_classes = A dictionary mapping BeautifulSoup</span>
<span style="color: #a5d6ff">                classes like Tag and NavigableString, to other classes you'd</span>
<span style="color: #a5d6ff">                like to be instantiated instead as the parse tree is</span>
<span style="color: #a5d6ff">                built.</span>
<span style="color: #a5d6ff">            **kwargs = For backwards compatibility purposes.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            soup: An instance of the BeautifulSoup class</span>

<span style="color: #a5d6ff">        Todo:</span>
<span style="color: #a5d6ff">            - Write tests for this function</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; soup = self.helpers.beautifulsoup(event.data["body"], "html.parser")</span>
<span style="color: #a5d6ff">            Perform an html parse of the 'markup' argument and return a soup instance</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; email_type = soup.find(type="email")</span>
<span style="color: #a5d6ff">            Searches the soup instance for all occurances of the passed in argument</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">soup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BeautifulSoup(</span>
                <span style="color: #e6edf3">markup,</span> <span style="color: #e6edf3">features,</span> <span style="color: #e6edf3">builder,</span> <span style="color: #e6edf3">parse_only,</span> <span style="color: #e6edf3">from_encoding,</span> <span style="color: #e6edf3">exclude_encodings,</span> <span style="color: #e6edf3">element_classes,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs</span>
            <span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">soup</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error parsing beautifulsoup: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #e6edf3">user_keywords</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">compile(r,</span> <span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">I)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"user"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"login"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"email"</span><span style="color: #e6edf3">]]</span>
    <span style="color: #e6edf3">pass_keywords</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">compile(r,</span> <span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">I)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"pass"</span><span style="color: #e6edf3">]]</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_login_page</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">html):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        TODO: convert this into an excavate YARA rule</span>

<span style="color: #a5d6ff">        Determines if the provided HTML content contains a login page.</span>

<span style="color: #a5d6ff">        This function parses the HTML to search for forms with input fields typically used for</span>
<span style="color: #a5d6ff">        authentication. If it identifies password fields or a combination of username and password</span>
<span style="color: #a5d6ff">        fields, it returns True.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            html (str): The HTML content to analyze.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            bool: True if the HTML contains a login page, otherwise False.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; is_login_page('&lt;form&gt;&lt;input type="text" name="username"&gt;&lt;input type="password" name="password"&gt;&lt;/form&gt;')</span>
<span style="color: #a5d6ff">            True</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; is_login_page('&lt;form&gt;&lt;input type="text" name="search"&gt;&lt;/form&gt;')</span>
<span style="color: #a5d6ff">            False</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">soup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BeautifulSoup(html,</span> <span style="color: #a5d6ff">"html.parser"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error parsing html: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

        <span style="color: #e6edf3">forms</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">soup</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"form"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># first, check for obvious password fields</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">form</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">forms:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"password"</span><span style="color: #e6edf3">}):</span>
                <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>

        <span style="color: #8b949e; font-style: italic"># next, check for forms that have both a user-like and password-like field</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">form</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">forms:</span>
            <span style="color: #e6edf3">user_fields</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum(bool(form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"name"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">r}))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">user_keywords)</span>
            <span style="color: #e6edf3">pass_fields</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum(bool(form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"name"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">r}))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pass_keywords)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">user_fields</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">pass_fields:</span>
                <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">response_to_json</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">response):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Convert web response to JSON object, similar to the output of `httpx -irr -json`</span>
<span style="color: #a5d6ff">        """</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span>

        <span style="color: #ff7b72">import</span> <span style="color: #ff7b72">mmh3</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">datetime</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">datetime</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">hashlib</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">md5,</span> <span style="color: #e6edf3">sha256</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">bbot.core.helpers.misc</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">tagify,</span> <span style="color: #e6edf3">urlparse,</span> <span style="color: #e6edf3">split_host_port,</span> <span style="color: #e6edf3">smart_decode</span>

        <span style="color: #e6edf3">request</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request</span>
        <span style="color: #e6edf3">url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(request</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url)</span>
        <span style="color: #e6edf3">parsed_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">urlparse(url)</span>
        <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">netloc</span>
        <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scheme</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
        <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">scheme</span><span style="color: #a5d6ff">}://{</span><span style="color: #e6edf3">netloc</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">raw_headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\r\n</span><span style="color: #a5d6ff">"</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()])</span>
        <span style="color: #e6edf3">raw_headers_encoded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">raw_headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">encode()</span>

        <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tagify(k,</span> <span style="color: #e6edf3">delimiter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"_"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">headers[k]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">v</span>

        <span style="color: #e6edf3">j</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
            <span style="color: #a5d6ff">"timestamp"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isoformat(),</span>
            <span style="color: #a5d6ff">"hash"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span>
                <span style="color: #a5d6ff">"body_md5"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">md5(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
                <span style="color: #a5d6ff">"body_mmh3"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">mmh3</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hash(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content),</span>
                <span style="color: #a5d6ff">"body_sha256"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">sha256(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
                <span style="color: #8b949e; font-style: italic"># "body_simhash": "TODO",</span>
                <span style="color: #a5d6ff">"header_md5"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">md5(raw_headers_encoded)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
                <span style="color: #a5d6ff">"header_mmh3"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">mmh3</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hash(raw_headers_encoded),</span>
                <span style="color: #a5d6ff">"header_sha256"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">sha256(raw_headers_encoded)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
                <span style="color: #8b949e; font-style: italic"># "header_simhash": "TODO",</span>
            <span style="color: #e6edf3">},</span>
            <span style="color: #a5d6ff">"header"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">headers,</span>
            <span style="color: #a5d6ff">"body"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">smart_decode(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content),</span>
            <span style="color: #a5d6ff">"content_type"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"content_type"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">";"</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(),</span>
            <span style="color: #a5d6ff">"url"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">url,</span>
            <span style="color: #a5d6ff">"host"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">str(host),</span>
            <span style="color: #a5d6ff">"port"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">port,</span>
            <span style="color: #a5d6ff">"scheme"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">scheme,</span>
            <span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">method,</span>
            <span style="color: #a5d6ff">"path"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">path,</span>
            <span style="color: #a5d6ff">"raw_header"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">raw_headers,</span>
            <span style="color: #a5d6ff">"status_code"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_code,</span>
        <span style="color: #e6edf3">}</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">j</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.ERROR_CLASS">
<span class="doc doc-object-name doc-attribute-name">ERROR_CLASS</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
<small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">ERROR_CLASS</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">WebError</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Main utility class for managing HTTP operations in BBOT. It serves as a wrapper around the BBOTAsyncClient,
which itself is a subclass of httpx.AsyncClient. The class provides functionalities to make HTTP requests,
download files, and handle cached wordlists.</p>
<p><span class="doc-section-title">Attributes:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code><span title="bbot.core.helpers.web.WebHelper.ERROR_CLASS.parent_helper">parent_helper</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#object">object</a></code>)
          
          <div class="doc-md-description">
<p>The parent helper object containing scan configurations.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.core.helpers.web.WebHelper.ERROR_CLASS.http_debug">http_debug</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Flag to indicate whether HTTP debugging is enabled.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.core.helpers.web.WebHelper.ERROR_CLASS.ssl_verify">ssl_verify</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Flag to indicate whether SSL verification is enabled.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.core.helpers.web.WebHelper.ERROR_CLASS.web_client">web_client</span></code></b>
              (<code>BBOTAsyncClient</code>)
          
          <div class="doc-md-description">
<p>An instance of BBOTAsyncClient for making HTTP requests.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.core.helpers.web.WebHelper.ERROR_CLASS.client_only_options">client_only_options</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#tuple">tuple</a></code>)
          
          <div class="doc-md-description">
<p>A tuple of options only applicable to the web client.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<p>Basic web request:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span><span style="color: #a5d6ff">"https://www.evilcorp.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<p>Download file:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">download(</span><span style="color: #a5d6ff">"https://www.evilcorp.com/passwords.docx"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<p>Download wordlist (cached for 30 days by default):</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wordlist(</span><span style="color: #a5d6ff">"https://www.evilcorp.com/wordlist.txt"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.api_page_iter">
<span class="doc doc-object-name doc-function-name">api_page_iter</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">api_page_iter(url,</span> <span style="color: #e6edf3">page_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">next_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">requests_kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>An asynchronous generator function for iterating through paginated API data.</p>
<p>This function continuously makes requests to a specified API URL, incrementing the page number
or applying a custom pagination function, and yields the received data one page at a time.
It is well-suited for APIs that provide paginated results.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>url</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The initial API URL. Can contain placeholders for 'page', 'page_size', and 'offset'.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>page_size</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                  <code>100</code>
)
          
          <div class="doc-md-description">
<p>The number of items per page. Defaults to 100.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>json</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          
          <div class="doc-md-description">
<p>If True, attempts to deserialize the response content to a JSON object. Defaults to True.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>next_key</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#callable">callable</a></code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
<p>A function that takes the last page's data and returns the URL for the next page. Defaults to None.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**requests_kwargs</code></b>
          
          <div class="doc-md-description">
<p>Arbitrary keyword arguments that will be forwarded to the HTTP request function.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Yields:</span></p>
<ul>
<li class="doc-section-item field-body">
          
          <div class="doc-md-description">
<p>dict or httpx.Response: If 'json' is True, yields a dictionary containing the parsed JSON data. Otherwise, yields the raw HTTP response.</p>
</div>
</li>
</ul>
<details class="note" open="">
<summary>Note</summary>
<p>The loop will continue indefinitely unless manually stopped. Make sure to break out of the loop once the last page has been received.</p>
</details>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">api_page_iter(</span><span style="color: #a5d6ff">'https://api.example.com/data?page={page}&amp;page_size={page_size}'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">page</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">agen:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>        <span style="color: #e6edf3">subdomains</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">page[</span><span style="color: #a5d6ff">"subdomains"</span><span style="color: #e6edf3">]</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(subdomains)</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">subdomains:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>            <span style="color: #ff7b72">break</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">330</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">api_page_iter</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">url,</span> <span style="color: #e6edf3">page_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">json</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">next_key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">requests_kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    An asynchronous generator function for iterating through paginated API data.</span>

<span style="color: #a5d6ff">    This function continuously makes requests to a specified API URL, incrementing the page number</span>
<span style="color: #a5d6ff">    or applying a custom pagination function, and yields the received data one page at a time.</span>
<span style="color: #a5d6ff">    It is well-suited for APIs that provide paginated results.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        url (str): The initial API URL. Can contain placeholders for 'page', 'page_size', and 'offset'.</span>
<span style="color: #a5d6ff">        page_size (int, optional): The number of items per page. Defaults to 100.</span>
<span style="color: #a5d6ff">        json (bool, optional): If True, attempts to deserialize the response content to a JSON object. Defaults to True.</span>
<span style="color: #a5d6ff">        next_key (callable, optional): A function that takes the last page's data and returns the URL for the next page. Defaults to None.</span>
<span style="color: #a5d6ff">        **requests_kwargs: Arbitrary keyword arguments that will be forwarded to the HTTP request function.</span>

<span style="color: #a5d6ff">    Yields:</span>
<span style="color: #a5d6ff">        dict or httpx.Response: If 'json' is True, yields a dictionary containing the parsed JSON data. Otherwise, yields the raw HTTP response.</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        The loop will continue indefinitely unless manually stopped. Make sure to break out of the loop once the last page has been received.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; agen = api_page_iter('https://api.example.com/data?page={page}&amp;page_size={page_size}')</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; try:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     async for page in agen:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;         subdomains = page["subdomains"]</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;         self.hugesuccess(subdomains)</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;         if not subdomains:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;             break</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; finally:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     agen.aclose()</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">page</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">1</span>
    <span style="color: #e6edf3">offset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
    <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">callable(next_key):</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">new_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">next_key(result)</span>
            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to extract next page of results from {</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">new_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format(page</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">page,</span> <span style="color: #e6edf3">page_size</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">page_size,</span> <span style="color: #e6edf3">offset</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">offset)</span>
        <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(new_url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">requests_kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"api_page_iter() got no response for {</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">break</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">json:</span>
                <span style="color: #e6edf3">result</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">result</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json()</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">result</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Error in api_page_iter() for url: "{</span><span style="color: #e6edf3">new_url</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
            <span style="color: #ff7b72">break</span>
        <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">offset</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">page_size</span>
            <span style="color: #e6edf3">page</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">1</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.beautifulsoup">
<span class="doc doc-object-name doc-function-name">beautifulsoup</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">beautifulsoup(markup,</span> <span style="color: #e6edf3">features</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">'html.parser'</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">builder</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">parse_only</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">from_encoding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">exclude_encodings</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">element_classes</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Naviate, Search, Modify, Parse, or PrettyPrint HTML Content.
More information at https://beautiful-soup-4.readthedocs.io/en/latest/</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>markup</code></b>
          
          <div class="doc-md-description">
<p>A string or a file-like object representing markup to be parsed.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>features</code></b>
          
          <div class="doc-md-description">
<p>Desirable features of the parser to be used.
This may be the name of a specific parser ("lxml",
"lxml-xml", "html.parser", or "html5lib") or it may be
the type of markup to be used ("html", "html5", "xml").
Defaults to 'html.parser'.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>builder</code></b>
          
          <div class="doc-md-description">
<p>A TreeBuilder subclass to instantiate (or instance to use)
instead of looking one up based on <code>features</code>.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>parse_only</code></b>
          
          <div class="doc-md-description">
<p>A SoupStrainer. Only parts of the document
matching the SoupStrainer will be considered.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>from_encoding</code></b>
          
          <div class="doc-md-description">
<p>A string indicating the encoding of the
document to be parsed.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>soup</code></b>          
          <div class="doc-md-description">
<p>An instance of the BeautifulSoup class</p>
</div>
</li>
</ul>
<details class="todo" open="">
<summary>Todo</summary>
<ul>
<li>Write tests for this function</li>
</ul>
</details>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">soup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">beautifulsoup(event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">data[</span><span style="color: #a5d6ff">"body"</span><span style="color: #e6edf3">],</span> <span style="color: #a5d6ff">"html.parser"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">Perform an html parse of the 'markup' argument and return a soup instance</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">email_type</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">soup</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find(type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"email"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">Searches the soup instance for all occurances of the passed in argument</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">460</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">507</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">beautifulsoup</span><span style="color: #e6edf3">(</span>
    <span style="color: #e6edf3">self,</span>
    <span style="color: #e6edf3">markup,</span>
    <span style="color: #e6edf3">features</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"html.parser"</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">builder</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">parse_only</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">from_encoding</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">exclude_encodings</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">element_classes</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs,</span>
<span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Naviate, Search, Modify, Parse, or PrettyPrint HTML Content.</span>
<span style="color: #a5d6ff">    More information at https://beautiful-soup-4.readthedocs.io/en/latest/</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        markup: A string or a file-like object representing markup to be parsed.</span>
<span style="color: #a5d6ff">        features: Desirable features of the parser to be used.</span>
<span style="color: #a5d6ff">            This may be the name of a specific parser ("lxml",</span>
<span style="color: #a5d6ff">            "lxml-xml", "html.parser", or "html5lib") or it may be</span>
<span style="color: #a5d6ff">            the type of markup to be used ("html", "html5", "xml").</span>
<span style="color: #a5d6ff">            Defaults to 'html.parser'.</span>
<span style="color: #a5d6ff">        builder: A TreeBuilder subclass to instantiate (or instance to use)</span>
<span style="color: #a5d6ff">            instead of looking one up based on `features`.</span>
<span style="color: #a5d6ff">        parse_only: A SoupStrainer. Only parts of the document</span>
<span style="color: #a5d6ff">            matching the SoupStrainer will be considered.</span>
<span style="color: #a5d6ff">        from_encoding: A string indicating the encoding of the</span>
<span style="color: #a5d6ff">            document to be parsed.</span>
<span style="color: #a5d6ff">        exclude_encodings = A list of strings indicating</span>
<span style="color: #a5d6ff">            encodings known to be wrong.</span>
<span style="color: #a5d6ff">        element_classes = A dictionary mapping BeautifulSoup</span>
<span style="color: #a5d6ff">            classes like Tag and NavigableString, to other classes you'd</span>
<span style="color: #a5d6ff">            like to be instantiated instead as the parse tree is</span>
<span style="color: #a5d6ff">            built.</span>
<span style="color: #a5d6ff">        **kwargs = For backwards compatibility purposes.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        soup: An instance of the BeautifulSoup class</span>

<span style="color: #a5d6ff">    Todo:</span>
<span style="color: #a5d6ff">        - Write tests for this function</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; soup = self.helpers.beautifulsoup(event.data["body"], "html.parser")</span>
<span style="color: #a5d6ff">        Perform an html parse of the 'markup' argument and return a soup instance</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; email_type = soup.find(type="email")</span>
<span style="color: #a5d6ff">        Searches the soup instance for all occurances of the passed in argument</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">soup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BeautifulSoup(</span>
            <span style="color: #e6edf3">markup,</span> <span style="color: #e6edf3">features,</span> <span style="color: #e6edf3">builder,</span> <span style="color: #e6edf3">parse_only,</span> <span style="color: #e6edf3">from_encoding,</span> <span style="color: #e6edf3">exclude_encodings,</span> <span style="color: #e6edf3">element_classes,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs</span>
        <span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">soup</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error parsing beautifulsoup: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.curl">
<span class="doc doc-object-name doc-function-name">curl</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">curl(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>An asynchronous function that runs a cURL command with specified arguments and options.</p>
<p>This function constructs and executes a cURL command based on the provided parameters.
It offers support for various cURL options such as headers, post data, and cookies.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>*args</code></b>
          
          <div class="doc-md-description">
<p>Variable length argument list for positional arguments. Unused in this function.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>url</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The URL for the cURL request. Mandatory.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>raw_path</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>If True, activates '--path-as-is' in cURL. Defaults to False.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>headers</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>A dictionary of HTTP headers to include in the request.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>ignore_bbot_global_settings</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>If True, ignores the global settings of BBOT. Defaults to False.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>post_data</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>A dictionary containing data to be sent in the request body.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>method</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The HTTP method to use for the request (e.g., 'GET', 'POST').</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>cookies</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>A dictionary of cookies to include in the request.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>path_override</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>Overrides the request-target to use in the HTTP request line.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>head_mode</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>If True, includes '-I' to fetch headers only. Defaults to None.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>raw_body</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>Raw string to be sent in the body of the request.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**kwargs</code></b>
          
          <div class="doc-md-description">
<p>Arbitrary keyword arguments that will be forwarded to the HTTP request function.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>str</code></b>          
          <div class="doc-md-description">
<p>The output of the cURL command.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><span title="bbot.errors.CurlError">CurlError</span></code>
            
          <div class="doc-md-description">
<p>If 'url' is not supplied.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">output</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">curl(url</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"https://example.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"X-Header"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"Wat"</span><span style="color: #e6edf3">})</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">print(output)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">449</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">curl</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    An asynchronous function that runs a cURL command with specified arguments and options.</span>

<span style="color: #a5d6ff">    This function constructs and executes a cURL command based on the provided parameters.</span>
<span style="color: #a5d6ff">    It offers support for various cURL options such as headers, post data, and cookies.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        *args: Variable length argument list for positional arguments. Unused in this function.</span>
<span style="color: #a5d6ff">        url (str): The URL for the cURL request. Mandatory.</span>
<span style="color: #a5d6ff">        raw_path (bool, optional): If True, activates '--path-as-is' in cURL. Defaults to False.</span>
<span style="color: #a5d6ff">        headers (dict, optional): A dictionary of HTTP headers to include in the request.</span>
<span style="color: #a5d6ff">        ignore_bbot_global_settings (bool, optional): If True, ignores the global settings of BBOT. Defaults to False.</span>
<span style="color: #a5d6ff">        post_data (dict, optional): A dictionary containing data to be sent in the request body.</span>
<span style="color: #a5d6ff">        method (str, optional): The HTTP method to use for the request (e.g., 'GET', 'POST').</span>
<span style="color: #a5d6ff">        cookies (dict, optional): A dictionary of cookies to include in the request.</span>
<span style="color: #a5d6ff">        path_override (str, optional): Overrides the request-target to use in the HTTP request line.</span>
<span style="color: #a5d6ff">        head_mode (bool, optional): If True, includes '-I' to fetch headers only. Defaults to None.</span>
<span style="color: #a5d6ff">        raw_body (str, optional): Raw string to be sent in the body of the request.</span>
<span style="color: #a5d6ff">        **kwargs: Arbitrary keyword arguments that will be forwarded to the HTTP request function.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        str: The output of the cURL command.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        CurlError: If 'url' is not supplied.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; output = await curl(url="https://example.com", headers={"X-Header": "Wat"})</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; print(output)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">url:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">CurlError(</span><span style="color: #a5d6ff">"No URL supplied to CURL helper"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">curl_command</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"curl"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">url,</span> <span style="color: #a5d6ff">"-s"</span><span style="color: #e6edf3">]</span>

    <span style="color: #e6edf3">raw_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"raw_path"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raw_path:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"--path-as-is"</span><span style="color: #e6edf3">)</span>

    <span style="color: #8b949e; font-style: italic"># respect global ssl verify settings</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ssl_verify</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-k"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>

    <span style="color: #e6edf3">ignore_bbot_global_settings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"ignore_bbot_global_settings"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">ignore_bbot_global_settings:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"ignore_bbot_global_settings enabled. Global settings will not be applied"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">http_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">user_agent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"user_agent"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"BBOT"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"User-Agent"</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">headers:</span>
            <span style="color: #e6edf3">headers[</span><span style="color: #a5d6ff">"User-Agent"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">user_agent</span>

        <span style="color: #8b949e; font-style: italic"># only add custom headers if the URL is in-scope</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_scope(url):</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">hk,</span> <span style="color: #e6edf3">hv</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">headers[hk]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">hv</span>

        <span style="color: #8b949e; font-style: italic"># add the timeout</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"timeout"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
            <span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">http_timeout</span>

        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-m"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(str(timeout))</span>

    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">isinstance(v,</span> <span style="color: #e6edf3">list):</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">v:</span>
                <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-H"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">x</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-H"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">post_data</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"post_data"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(post_data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items())</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-d"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">post_data_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">post_data</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #e6edf3">post_data_str</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"&amp;{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}={</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(post_data_str</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lstrip(</span><span style="color: #a5d6ff">"&amp;"</span><span style="color: #e6edf3">))</span>

    <span style="color: #e6edf3">method</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">method:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-X"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(method)</span>

    <span style="color: #e6edf3">cookies</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"cookies"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">cookies:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-b"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">cookies_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">""</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">cookies</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #e6edf3">cookies_str</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}={</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}; "</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'{</span><span style="color: #e6edf3">cookies_str</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rstrip(</span><span style="color: #a5d6ff">" "</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}'</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">path_override</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"path_override"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">path_override:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"--request-target"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">path_override</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">head_mode</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"head_mode"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">head_mode:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-I"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">raw_body</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"raw_body"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">raw_body:</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #a5d6ff">"-d"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">curl_command</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(raw_body)</span>

    <span style="color: #e6edf3">output</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">(</span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run(curl_command))</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stdout</span>
    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">output</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.download">
<span class="doc doc-object-name doc-function-name">download</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">download(url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronous function for downloading files from a given URL. Supports caching with an optional
time period in hours via the "cache_hrs" keyword argument. In case of successful download,
returns the full path of the saved filename. If the download fails, returns None.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>url</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The URL of the file to download.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>filename</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The filename to save the downloaded file as.
If not provided, will generate based on URL.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>max_size</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a> or <a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
          
          <div class="doc-md-description">
<p>Maximum filesize as a string ("5MB") or integer in bytes.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>cache_hrs</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>)
          
          <div class="doc-md-description">
<p>The number of hours to cache the downloaded file.
A negative value disables caching. Defaults to -1.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>method</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The HTTP method to use for the request, defaults to 'GET'.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>raise_error</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**kwargs</code></b>
          
          <div class="doc-md-description">
<p>Additional keyword arguments to pass to the httpx request.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
          
          <div class="doc-md-description">
<p>Path or None: The full path of the downloaded file as a Path object if successful, otherwise None.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">filepath</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">download(</span><span style="color: #a5d6ff">"https://www.evilcorp.com/passwords.docx"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">cache_hrs</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">24</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">download</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Asynchronous function for downloading files from a given URL. Supports caching with an optional</span>
<span style="color: #a5d6ff">    time period in hours via the "cache_hrs" keyword argument. In case of successful download,</span>
<span style="color: #a5d6ff">    returns the full path of the saved filename. If the download fails, returns None.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        url (str): The URL of the file to download.</span>
<span style="color: #a5d6ff">        filename (str, optional): The filename to save the downloaded file as.</span>
<span style="color: #a5d6ff">            If not provided, will generate based on URL.</span>
<span style="color: #a5d6ff">        max_size (str or int): Maximum filesize as a string ("5MB") or integer in bytes.</span>
<span style="color: #a5d6ff">        cache_hrs (float, optional): The number of hours to cache the downloaded file.</span>
<span style="color: #a5d6ff">            A negative value disables caching. Defaults to -1.</span>
<span style="color: #a5d6ff">        method (str, optional): The HTTP method to use for the request, defaults to 'GET'.</span>
<span style="color: #a5d6ff">        raise_error (bool, optional): Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</span>
<span style="color: #a5d6ff">        **kwargs: Additional keyword arguments to pass to the httpx request.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Path or None: The full path of the downloaded file as a Path object if successful, otherwise None.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; filepath = await self.helpers.download("https://www.evilcorp.com/passwords.docx", cache_hrs=24)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"filename"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(url))</span>
    <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">truncate_filename(Path(filename)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve())</span>
    <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"filename"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">filename</span>
    <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"max_size"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">max_size</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">human_to_bytes(max_size)</span>
        <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"max_size"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max_size</span>
    <span style="color: #e6edf3">cache_hrs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">float(kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"cache_hrs"</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">cache_hrs</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_cached(url):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">url</span><span style="color: #a5d6ff">} is cached at {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(url)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">success</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"download"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">url,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">success:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filename</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.is_login_page">
<span class="doc doc-object-name doc-function-name">is_login_page</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_login_page(html)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>TODO: convert this into an excavate YARA rule</p>
<p>Determines if the provided HTML content contains a login page.</p>
<p>This function parses the HTML to search for forms with input fields typically used for
authentication. If it identifies password fields or a combination of username and password
fields, it returns True.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>html</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The HTML content to analyze.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>bool</code></b>          
          <div class="doc-md-description">
<p>True if the HTML contains a login page, otherwise False.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_login_page(</span><span style="color: #a5d6ff">'&lt;form&gt;&lt;input type="text" name="username"&gt;&lt;input type="password" name="password"&gt;&lt;/form&gt;'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">True</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_login_page(</span><span style="color: #a5d6ff">'&lt;form&gt;&lt;input type="text" name="search"&gt;&lt;/form&gt;'</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">False</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">554</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_login_page</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">html):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    TODO: convert this into an excavate YARA rule</span>

<span style="color: #a5d6ff">    Determines if the provided HTML content contains a login page.</span>

<span style="color: #a5d6ff">    This function parses the HTML to search for forms with input fields typically used for</span>
<span style="color: #a5d6ff">    authentication. If it identifies password fields or a combination of username and password</span>
<span style="color: #a5d6ff">    fields, it returns True.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        html (str): The HTML content to analyze.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if the HTML contains a login page, otherwise False.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_login_page('&lt;form&gt;&lt;input type="text" name="username"&gt;&lt;input type="password" name="password"&gt;&lt;/form&gt;')</span>
<span style="color: #a5d6ff">        True</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_login_page('&lt;form&gt;&lt;input type="text" name="search"&gt;&lt;/form&gt;')</span>
<span style="color: #a5d6ff">        False</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">soup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">BeautifulSoup(html,</span> <span style="color: #a5d6ff">"html.parser"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error parsing html: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #e6edf3">forms</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">soup</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"form"</span><span style="color: #e6edf3">)</span>

    <span style="color: #8b949e; font-style: italic"># first, check for obvious password fields</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">form</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">forms:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"type"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"password"</span><span style="color: #e6edf3">}):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>

    <span style="color: #8b949e; font-style: italic"># next, check for forms that have both a user-like and password-like field</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">form</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">forms:</span>
        <span style="color: #e6edf3">user_fields</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum(bool(form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"name"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">r}))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">user_keywords)</span>
        <span style="color: #e6edf3">pass_fields</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum(bool(form</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">find_all(</span><span style="color: #a5d6ff">"input"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"name"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">r}))</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">r</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pass_keywords)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">user_fields</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">pass_fields:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.request">
<span class="doc doc-object-name doc-function-name">request</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">request(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronous function for making HTTP requests, intended to be the most basic web request function
used widely across BBOT and within this helper class. Handles various exceptions and timeouts
that might occur during the request.</p>
<p>This function automatically respects the scan's global timeout, proxy, headers, etc.
Headers you specify will be merged with the scan's. Your arguments take ultimate precedence,
meaning you can override the scan's values if you want.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>url</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The URL to send the request to.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>method</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The HTTP method to use for the request. Defaults to 'GET'.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>headers</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary of HTTP headers to send with the request.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>params</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary, list of tuples, or bytes to send in the query string.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>cookies</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary or CookieJar object containing cookies.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>json</code></b>
              (<code>Any</code>)
          
          <div class="doc-md-description">
<p>A JSON serializable Python object to send in the body.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>data</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary, list of tuples, or bytes to send in the body.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>files</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary of 'name': file-like-objects for multipart encoding upload.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>auth</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#tuple">tuple</a></code>)
          
          <div class="doc-md-description">
<p>Auth tuple to enable Basic/Digest/Custom HTTP auth.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>timeout</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>)
          
          <div class="doc-md-description">
<p>The maximum time to wait for the request to complete.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>proxies</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          
          <div class="doc-md-description">
<p>Dictionary mapping protocol schemes to proxy URLs.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>allow_redirects</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Enables or disables redirection. Defaults to None.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>stream</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Enables or disables response streaming.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>raise_error</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          
          <div class="doc-md-description">
<p>Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>client</code></b>
              (<code><span title="httpx.AsyncClient">AsyncClient</span></code>)
          
          <div class="doc-md-description">
<p>A specific httpx.AsyncClient to use for the request. Defaults to self.web_client.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>cache_for</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
          
          <div class="doc-md-description">
<p>Time in seconds to cache the request. Not used currently. Defaults to None.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><span title="httpx.TimeoutException">TimeoutException</span></code>
            
          <div class="doc-md-description">
<p>If the request times out.</p>
</div>
</li>
<li class="doc-section-item field-body">
<code><span title="httpx.ConnectError">ConnectError</span></code>
            
          <div class="doc-md-description">
<p>If the connection fails.</p>
</div>
</li>
<li class="doc-section-item field-body">
<code><span title="httpx.RequestError">RequestError</span></code>
            
          <div class="doc-md-description">
<p>For other request-related errors.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
          
          <div class="doc-md-description">
<p>httpx.Response or None: The HTTP response object returned by the httpx library.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span><span style="color: #a5d6ff">"https://www.evilcorp.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request(</span><span style="color: #a5d6ff">"https://api.evilcorp.com/"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">method</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"POST"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">data</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"stuff"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p>If the web request fails, it will return None unless <code>raise_error</code> is <code>True</code>.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Asynchronous function for making HTTP requests, intended to be the most basic web request function</span>
<span style="color: #a5d6ff">    used widely across BBOT and within this helper class. Handles various exceptions and timeouts</span>
<span style="color: #a5d6ff">    that might occur during the request.</span>

<span style="color: #a5d6ff">    This function automatically respects the scan's global timeout, proxy, headers, etc.</span>
<span style="color: #a5d6ff">    Headers you specify will be merged with the scan's. Your arguments take ultimate precedence,</span>
<span style="color: #a5d6ff">    meaning you can override the scan's values if you want.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        url (str): The URL to send the request to.</span>
<span style="color: #a5d6ff">        method (str, optional): The HTTP method to use for the request. Defaults to 'GET'.</span>
<span style="color: #a5d6ff">        headers (dict, optional): Dictionary of HTTP headers to send with the request.</span>
<span style="color: #a5d6ff">        params (dict, optional): Dictionary, list of tuples, or bytes to send in the query string.</span>
<span style="color: #a5d6ff">        cookies (dict, optional): Dictionary or CookieJar object containing cookies.</span>
<span style="color: #a5d6ff">        json (Any, optional): A JSON serializable Python object to send in the body.</span>
<span style="color: #a5d6ff">        data (dict, optional): Dictionary, list of tuples, or bytes to send in the body.</span>
<span style="color: #a5d6ff">        files (dict, optional): Dictionary of 'name': file-like-objects for multipart encoding upload.</span>
<span style="color: #a5d6ff">        auth (tuple, optional): Auth tuple to enable Basic/Digest/Custom HTTP auth.</span>
<span style="color: #a5d6ff">        timeout (float, optional): The maximum time to wait for the request to complete.</span>
<span style="color: #a5d6ff">        proxies (dict, optional): Dictionary mapping protocol schemes to proxy URLs.</span>
<span style="color: #a5d6ff">        allow_redirects (bool, optional): Enables or disables redirection. Defaults to None.</span>
<span style="color: #a5d6ff">        stream (bool, optional): Enables or disables response streaming.</span>
<span style="color: #a5d6ff">        raise_error (bool, optional): Whether to raise exceptions for HTTP connect, timeout errors. Defaults to False.</span>
<span style="color: #a5d6ff">        client (httpx.AsyncClient, optional): A specific httpx.AsyncClient to use for the request. Defaults to self.web_client.</span>
<span style="color: #a5d6ff">        cache_for (int, optional): Time in seconds to cache the request. Not used currently. Defaults to None.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        httpx.TimeoutException: If the request times out.</span>
<span style="color: #a5d6ff">        httpx.ConnectError: If the connection fails.</span>
<span style="color: #a5d6ff">        httpx.RequestError: For other request-related errors.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        httpx.Response or None: The HTTP response object returned by the httpx library.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; response = await self.helpers.request("https://www.evilcorp.com")</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; response = await self.helpers.request("https://api.evilcorp.com/", method="POST", data="stuff")</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        If the web request fails, it will return None unless `raise_error` is `True`.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"request"</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.request_batch">
<span class="doc doc-object-name doc-function-name">request_batch</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">request_batch(urls,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Given a list of URLs, request them in parallel and yield responses as they come in.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>urls</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>)
          
          <div class="doc-md-description">
<p>List of URLs to visit</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>*args</code></b>
          
          <div class="doc-md-description">
<p>Positional arguments to pass through to httpx</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**kwargs</code></b>
          
          <div class="doc-md-description">
<p>Keyword arguments to pass through to httpx</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">url,</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request_batch(urls,</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"X-Test"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"Test"</span><span style="color: #e6edf3">}):</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_code</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">200</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(response)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">urls,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Given a list of URLs, request them in parallel and yield responses as they come in.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        urls (list[str]): List of URLs to visit</span>
<span style="color: #a5d6ff">        *args: Positional arguments to pass through to httpx</span>
<span style="color: #a5d6ff">        **kwargs: Keyword arguments to pass through to httpx</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async for url, response in self.helpers.request_batch(urls, headers={"X-Test": "Test"}):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     if response is not None and response.status_code == 200:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;         self.hugesuccess(response)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"request_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">urls,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
            <span style="color: #ff7b72">break</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.request_custom_batch">
<span class="doc doc-object-name doc-function-name">request_custom_batch</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">request_custom_batch(urls_and_kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Make web requests in parallel with custom options for each request. Yield responses as they come in.</p>
<p>Similar to <code>request_batch</code> except it allows individual arguments for each URL.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>urls_and_kwargs</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#tuple">tuple</a>]</code>)
          
          <div class="doc-md-description">
<p>List of tuples in the format: (url, kwargs, custom_tracker)
where custom_tracker is an optional value for your own internal use. You may use it to
help correlate requests, etc.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">urls_and_kwargs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"http://evilcorp.com/1"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"GET"</span><span style="color: #e6edf3">},</span> <span style="color: #a5d6ff">"request-1"</span><span style="color: #e6edf3">),</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"http://evilcorp.com/2"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"POST"</span><span style="color: #e6edf3">},</span> <span style="color: #a5d6ff">"request-2"</span><span style="color: #e6edf3">),</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">]</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">url,</span> <span style="color: #e6edf3">kwargs,</span> <span style="color: #e6edf3">custom_tracker,</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request_custom_batch(</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">urls_and_kwargs</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">):</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_code</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">200</span><span style="color: #e6edf3">:</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(response)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">request_custom_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">urls_and_kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Make web requests in parallel with custom options for each request. Yield responses as they come in.</span>

<span style="color: #a5d6ff">    Similar to `request_batch` except it allows individual arguments for each URL.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        urls_and_kwargs (list[tuple]): List of tuples in the format: (url, kwargs, custom_tracker)</span>
<span style="color: #a5d6ff">            where custom_tracker is an optional value for your own internal use. You may use it to</span>
<span style="color: #a5d6ff">            help correlate requests, etc.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; urls_and_kwargs = [</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     ("http://evilcorp.com/1", {"method": "GET"}, "request-1"),</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     ("http://evilcorp.com/2", {"method": "POST"}, "request-2"),</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; ]</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async for url, kwargs, custom_tracker, response in self.helpers.request_custom_batch(</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     urls_and_kwargs</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; ):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     if response is not None and response.status_code == 200:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;         self.hugesuccess(response)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"request_custom_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">urls_and_kwargs)</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
            <span style="color: #ff7b72">break</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.response_to_json">
<span class="doc doc-object-name doc-function-name">response_to_json</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">response_to_json(response)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Convert web response to JSON object, similar to the output of <code>httpx -irr -json</code></p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">565</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">586</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">587</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">588</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">589</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">590</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">591</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">609</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">response_to_json</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">response):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Convert web response to JSON object, similar to the output of `httpx -irr -json`</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">response</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span>

    <span style="color: #ff7b72">import</span> <span style="color: #ff7b72">mmh3</span>
    <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">datetime</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">datetime</span>
    <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">hashlib</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">md5,</span> <span style="color: #e6edf3">sha256</span>
    <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">bbot.core.helpers.misc</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">tagify,</span> <span style="color: #e6edf3">urlparse,</span> <span style="color: #e6edf3">split_host_port,</span> <span style="color: #e6edf3">smart_decode</span>

    <span style="color: #e6edf3">request</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request</span>
    <span style="color: #e6edf3">url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(request</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url)</span>
    <span style="color: #e6edf3">parsed_url</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">urlparse(url)</span>
    <span style="color: #e6edf3">netloc</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">netloc</span>
    <span style="color: #e6edf3">scheme</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scheme</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
    <span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">port</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">split_host_port(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">scheme</span><span style="color: #a5d6ff">}://{</span><span style="color: #e6edf3">netloc</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">raw_headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"</span><span style="color: #79c0ff">\r\n</span><span style="color: #a5d6ff">"</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()])</span>
    <span style="color: #e6edf3">raw_headers_encoded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">raw_headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">encode()</span>

    <span style="color: #e6edf3">headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">k,</span> <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
        <span style="color: #e6edf3">k</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">tagify(k,</span> <span style="color: #e6edf3">delimiter</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"_"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">headers[k]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">v</span>

    <span style="color: #e6edf3">j</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
        <span style="color: #a5d6ff">"timestamp"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">isoformat(),</span>
        <span style="color: #a5d6ff">"hash"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span>
            <span style="color: #a5d6ff">"body_md5"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">md5(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
            <span style="color: #a5d6ff">"body_mmh3"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">mmh3</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hash(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content),</span>
            <span style="color: #a5d6ff">"body_sha256"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">sha256(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
            <span style="color: #8b949e; font-style: italic"># "body_simhash": "TODO",</span>
            <span style="color: #a5d6ff">"header_md5"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">md5(raw_headers_encoded)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
            <span style="color: #a5d6ff">"header_mmh3"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">mmh3</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hash(raw_headers_encoded),</span>
            <span style="color: #a5d6ff">"header_sha256"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">sha256(raw_headers_encoded)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest(),</span>
            <span style="color: #8b949e; font-style: italic"># "header_simhash": "TODO",</span>
        <span style="color: #e6edf3">},</span>
        <span style="color: #a5d6ff">"header"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">headers,</span>
        <span style="color: #a5d6ff">"body"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">smart_decode(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">content),</span>
        <span style="color: #a5d6ff">"content_type"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">headers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"content_type"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">split(</span><span style="color: #a5d6ff">";"</span><span style="color: #e6edf3">)[</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip(),</span>
        <span style="color: #a5d6ff">"url"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">url,</span>
        <span style="color: #a5d6ff">"host"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">str(host),</span>
        <span style="color: #a5d6ff">"port"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">port,</span>
        <span style="color: #a5d6ff">"scheme"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">scheme,</span>
        <span style="color: #a5d6ff">"method"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">request</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">method,</span>
        <span style="color: #a5d6ff">"path"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">parsed_url</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">path,</span>
        <span style="color: #a5d6ff">"raw_header"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">raw_headers,</span>
        <span style="color: #a5d6ff">"status_code"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_code,</span>
    <span style="color: #e6edf3">}</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">j</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.web.WebHelper.wordlist">
<span class="doc doc-object-name doc-function-name">wordlist</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">wordlist(path,</span> <span style="color: #e6edf3">lines</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronous function for retrieving wordlists, either from a local path or a URL.
Allows for optional line-based truncation and caching. Returns the full path of the wordlist
file or a truncated version of it.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>path</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The local or remote path of the wordlist.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>lines</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
<p>Number of lines to read from the wordlist.
If specified, will return a truncated wordlist with this many lines.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>cache_hrs</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#float">float</a></code>)
          
          <div class="doc-md-description">
<p>Number of hours to cache the downloaded wordlist.
Defaults to 720 hours (30 days) for remote wordlists.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**kwargs</code></b>
          
          <div class="doc-md-description">
<p>Additional keyword arguments to pass to the 'download' function for remote wordlists.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>Path</code></b>          
          <div class="doc-md-description">
<p>The full path of the wordlist (or its truncated version) as a Path object.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><span title="bbot.errors.WordlistError">WordlistError</span></code>
            
          <div class="doc-md-description">
<p>If the path is invalid or the wordlist could not be retrieved or found.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<p>Fetching full wordlist</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">wordlist_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wordlist(</span><span style="color: #a5d6ff">"https://www.evilcorp.com/wordlist.txt"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<p>Fetching and truncating to the first 100 lines</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">wordlist_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wordlist(</span><span style="color: #a5d6ff">"/root/rockyou.txt"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">lines</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">100</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/web/web.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">270</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">wordlist</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">path,</span> <span style="color: #e6edf3">lines</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Asynchronous function for retrieving wordlists, either from a local path or a URL.</span>
<span style="color: #a5d6ff">    Allows for optional line-based truncation and caching. Returns the full path of the wordlist</span>
<span style="color: #a5d6ff">    file or a truncated version of it.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        path (str): The local or remote path of the wordlist.</span>
<span style="color: #a5d6ff">        lines (int, optional): Number of lines to read from the wordlist.</span>
<span style="color: #a5d6ff">            If specified, will return a truncated wordlist with this many lines.</span>
<span style="color: #a5d6ff">        cache_hrs (float, optional): Number of hours to cache the downloaded wordlist.</span>
<span style="color: #a5d6ff">            Defaults to 720 hours (30 days) for remote wordlists.</span>
<span style="color: #a5d6ff">        **kwargs: Additional keyword arguments to pass to the 'download' function for remote wordlists.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        Path: The full path of the wordlist (or its truncated version) as a Path object.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        WordlistError: If the path is invalid or the wordlist could not be retrieved or found.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        Fetching full wordlist</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; wordlist_path = await self.helpers.wordlist("https://www.evilcorp.com/wordlist.txt")</span>

<span style="color: #a5d6ff">        Fetching and truncating to the first 100 lines</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; wordlist_path = await self.helpers.wordlist("/root/rockyou.txt", lines=100)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">path:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Invalid wordlist: {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"cache_hrs"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">kwargs:</span>
        <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"cache_hrs"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">720</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_url(path):</span>
        <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">download(str(path),</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unable to retrieve wordlist from {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(path)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">filename</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">is_file():</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">WordlistError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unable to find wordlist at {</span><span style="color: #e6edf3">path</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">lines</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">filename</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">lines</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(lines)</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(filename)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
            <span style="color: #e6edf3">read_lines</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">readlines()</span>
        <span style="color: #e6edf3">cache_key</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">lines</span><span style="color: #a5d6ff">}"</span>
        <span style="color: #e6edf3">truncated_filename</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cache_filename(cache_key)</span>
        <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(truncated_filename,</span> <span style="color: #a5d6ff">"w"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">read_lines[:lines]:</span>
                <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">write(line)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">truncated_filename</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tooltips", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "Stable", "provider": "mike"}}</script>
<script src="../../../assets/javascripts/bundle.af256bd8.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
<script src="../../../javascripts/tablesort.min.js"></script>
<script src="../../../javascripts/vega@5.js"></script>
<script src="../../../javascripts/vega-lite@5.js"></script>
<script src="../../../javascripts/vega-embed@6.js"></script>
</body>
</html>