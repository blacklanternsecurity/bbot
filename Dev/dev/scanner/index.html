
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/Dev/dev/scanner/" rel="canonical"/>
<link href="../discord_bot/" rel="prev"/>
<link href="../presets/" rel="next"/>
<link href="../../favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.26" name="generator"/>
<title>Scanner - BBOT Docs</title>
<link href="../../assets/stylesheets/main.6543a935.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/extra-style.ttfuu_ts.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#bbot.scanner.Scanner">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../.." title="BBOT Docs">
<img alt="logo" src="../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Scanner
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
          
  
  User Manual

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  Developer Manual

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="BBOT Docs">
<img alt="logo" src="../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    User Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_2" id="__nav_1_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Presets
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_2">
<span class="md-nav__icon md-icon"></span>
            Presets
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/presets/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/presets_list/">
<span class="md-ellipsis">
    List of Presets
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../contribution/">
<span class="md-ellipsis">
    Contribution
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Developer Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Developer Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Development Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dev_environment/">
<span class="md-ellipsis">
    Setting Up a Dev Environment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../architecture/">
<span class="md-ellipsis">
    BBOT Internal Architecture
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../module_howto/">
<span class="md-ellipsis">
    How to Write a BBOT Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tests/">
<span class="md-ellipsis">
    Unit Tests
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../discord_bot/">
<span class="md-ellipsis">
    Discord Bot Example
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
<span class="md-ellipsis">
    Code Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Scanner
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.dns_regexes">
<span class="md-ellipsis">
      dns_regexes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.dns_regexes_yara">
<span class="md-ellipsis">
      dns_regexes_yara
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.dns_strings">
<span class="md-ellipsis">
      dns_strings
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.json">
<span class="md-ellipsis">
      json
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.log_level">
<span class="md-ellipsis">
      log_level
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.root_event">
<span class="md-ellipsis">
      root_event
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.__init__">
<span class="md-ellipsis">
      __init__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.async_start">
<span class="md-ellipsis">
      async_start
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.finish">
<span class="md-ellipsis">
      finish
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.load_modules">
<span class="md-ellipsis">
      load_modules
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.setup_modules">
<span class="md-ellipsis">
      setup_modules
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bbot.scanner.Scanner.stop">
<span class="md-ellipsis">
      stop
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../presets/">
<span class="md-ellipsis">
    Presets
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../core/">
<span class="md-ellipsis">
    BBOTCore
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../engine/">
<span class="md-ellipsis">
    Engine
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_7_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7_8" id="__nav_2_7_8_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_7_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_7_8">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/interactsh/">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/misc/">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/web/">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../helpers/wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<div class="doc doc-object doc-class">
<h1 class="doc doc-heading" id="bbot.scanner.Scanner">
<span class="doc doc-object-name doc-class-name">Scanner</span>
</h1>
<div class="doc doc-contents first">
<p>A class representing a single BBOT scan</p>
<p><span class="doc-section-title">Examples:</span></p>
<p>Create scan with multiple targets:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">my_scan</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Scanner(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"1.2.3.0/24"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"portscan"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"sslcert"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"httpx"</span><span style="color: #e6edf3">])</span>
</code></pre></div>
<p>Create scan with custom config:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"http_proxy"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">"http://127.0.0.1:8080"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"modules"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"portscan"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"top_ports"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">2000</span><span style="color: #e6edf3">}}}</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">my_scan</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Scanner(</span><span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"portscan"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"httpx"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">config)</span>
</code></pre></div>
<p>Start the scan, iterating over events as they're discovered (synchronous):</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">for</span> <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">my_scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">start():</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">print(event)</span>
</code></pre></div>
<p>Start the scan, iterating over events as they're discovered (asynchronous):</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">my_scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">async_start():</span>
<span style="color: #8b949e">&gt;&gt;&gt; </span>    <span style="color: #e6edf3">print(event)</span>
</code></pre></div>
<p>Start the scan without consuming events (synchronous):</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">my_scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">start_without_generator()</span>
</code></pre></div>
<p>Start the scan without consuming events (asynchronous):</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">await</span> <span style="color: #e6edf3">my_scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">async_start_without_generator()</span>
</code></pre></div>
<p><span class="doc-section-title">Attributes:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.status">status</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
<p>Status of scan, representing its current state. It can take on the following string values, each of which is mapped to an integer code in <code>_status_codes</code>:
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"NOT_STARTED" (0): Initial status before the scan starts.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"STARTING" (1): Status when the scan is initializing.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"RUNNING" (2): Status when the scan is in progress.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"FINISHING" (3): Status when the scan is in the process of finalizing.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"CLEANING_UP" (4): Status when the scan is cleaning up resources.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"ABORTING" (5): Status when the scan is in the process of being aborted.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"ABORTED" (6): Status when the scan has been aborted.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"FAILED" (7): Status when the scan has encountered a failure.
<span style="color: #ff7b72">-</span><span style="color: #6e7681"> </span>"FINISHED" (8): Status when the scan has successfully completed.
</code></pre></div></p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner._status_code">_status_code</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
<p>The numerical representation of the current scan status, stored for internal use. It is mapped according to the values in <code>_status_codes</code>.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.target">target</span></code></b>
              (<code>Target</code>)
          –
          <div class="doc-md-description">
<p>Target of scan (alias to <code>self.preset.target</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.preset">preset</span></code></b>
              (<code><a class="autorefs autorefs-internal" title="bbot.scanner.preset.Preset" href="../presets/#bbot.scanner.Preset">Preset</a></code>)
          –
          <div class="doc-md-description">
<p>The main scan Preset in its baked form.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.config">config</span></code></b>
              (<code><span title="omegaconf.dictconfig.DictConfig">DictConfig</span></code>)
          –
          <div class="doc-md-description">
<p>BBOT config (alias to <code>self.preset.config</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.whitelist">whitelist</span></code></b>
              (<code>Target</code>)
          –
          <div class="doc-md-description">
<p>Scan whitelist (by default this is the same as <code>target</code>) (alias to <code>self.preset.whitelist</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.blacklist">blacklist</span></code></b>
              (<code>Target</code>)
          –
          <div class="doc-md-description">
<p>Scan blacklist (this takes ultimate precedence) (alias to <code>self.preset.blacklist</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.helpers">helpers</span></code></b>
              (<code>ConfigAwareHelper</code>)
          –
          <div class="doc-md-description">
<p>Helper containing various reusable functions, regexes, etc. (alias to <code>self.preset.helpers</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.output_dir">output_dir</span></code></b>
              (<code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
          –
          <div class="doc-md-description">
<p>Output directory for scan (alias to <code>self.preset.output_dir</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.name">name</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          –
          <div class="doc-md-description">
<p>Name of scan (alias to <code>self.preset.scan_name</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.dispatcher">dispatcher</span></code></b>
              (<code>Dispatcher</code>)
          –
          <div class="doc-md-description">
<p>Triggers certain events when the scan <code>status</code> changes.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.modules">modules</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#dict">dict</a></code>)
          –
          <div class="doc-md-description">
<p>Holds all loaded modules in this format: <code>{"module_name": Module()}</code>.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.stats">stats</span></code></b>
              (<code>ScanStats</code>)
          –
          <div class="doc-md-description">
<p>Holds high-level scan statistics such as how many events have been produced and consumed by each module.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.home">home</span></code></b>
              (<code><a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3.11/library/pathlib.html#pathlib.Path">Path</a></code>)
          –
          <div class="doc-md-description">
<p>Base output directory of the scan (default: <code>~/.bbot/scans/&lt;scan_name&gt;</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.running">running</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
<p>Whether the scan is currently running.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.stopping">stopping</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
<p>Whether the scan is currently stopping.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.stopped">stopped</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
<p>Whether the scan is currently stopped.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.aborting">aborting</span></code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
<p>Whether the scan is aborted or currently aborting.</p>
</div>
</li>
</ul>
<details class="notes" open="">
<summary>Notes</summary>
<ul>
<li>The status is read-only once set to "ABORTING" until it transitions to "ABORTED."</li>
<li>Invalid statuses are logged but not applied.</li>
<li>Setting a status will trigger the <code>on_status</code> event in the dispatcher.</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  24</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  25</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  26</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  27</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  28</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  29</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  30</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  31</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  32</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  33</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  34</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  35</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  36</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  37</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  38</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  39</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  40</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  41</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  42</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  43</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  44</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  45</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  46</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  47</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  72</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  73</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  74</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">  99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 236</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 237</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 238</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 239</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 240</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 241</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 242</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 243</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 244</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 245</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 246</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 247</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 248</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 249</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 250</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 251</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 252</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 253</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 254</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 255</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 256</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 257</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 258</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 259</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 260</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 261</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 262</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 263</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 264</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 265</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 266</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 267</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 268</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 269</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 270</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 271</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 272</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 273</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 274</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 275</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 276</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 277</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 278</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 279</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 280</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 281</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 282</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 283</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 284</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 285</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 286</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 287</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 288</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 289</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 290</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 291</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 292</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 293</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 294</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 295</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 296</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 297</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 298</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 299</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 300</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 301</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 302</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 303</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 412</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 413</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 414</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 415</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 416</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 417</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 418</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 460</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 461</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 551</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 552</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 553</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 554</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 555</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 556</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 557</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 558</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 559</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 560</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 561</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 562</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 563</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 564</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 565</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 566</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 567</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 568</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 569</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 570</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 571</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 572</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 573</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 574</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 575</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 576</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 577</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 578</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 579</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 580</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 581</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 582</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 583</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 584</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 585</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 586</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 587</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 588</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 589</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 590</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 591</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 592</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 593</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 594</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 595</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 596</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 597</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 598</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 599</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 600</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 601</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 602</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 603</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 604</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 605</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 606</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 607</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 608</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 609</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 610</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 611</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 612</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 613</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 614</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 615</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 616</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 617</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 618</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 619</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 620</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 621</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 622</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 623</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 624</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 625</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 626</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 627</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 628</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 629</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 630</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 631</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 632</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 633</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 634</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 635</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 636</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 637</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 638</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 639</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 640</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 641</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 642</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 643</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 644</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 645</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 646</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 647</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 648</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 649</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 650</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 651</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 652</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 653</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 654</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 655</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 656</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 657</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 658</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 659</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 660</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 661</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 662</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 663</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 664</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 665</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 666</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 667</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 668</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 669</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 670</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 671</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 672</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 673</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 674</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 675</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 676</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 677</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 678</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 679</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 680</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 681</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 682</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 683</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 684</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 685</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 686</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 687</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 688</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 689</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 690</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 691</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 692</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 693</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 694</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 695</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 696</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 697</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 698</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 699</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 700</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 701</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 702</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 703</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 704</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 705</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 706</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 707</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 708</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 709</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 710</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 711</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 712</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 713</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 714</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 715</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 716</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 717</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 718</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 719</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 720</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 721</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 722</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 723</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 724</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 725</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 726</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 727</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 728</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 729</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 730</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 731</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 732</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 733</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 734</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 735</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 736</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 737</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 738</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 739</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 740</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 741</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 742</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 743</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 744</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 745</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 746</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 747</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 748</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 749</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 750</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 751</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 752</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 753</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 754</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 755</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 756</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 757</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 758</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 759</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 760</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 761</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 762</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 763</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 764</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 765</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 766</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 767</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 768</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 769</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 770</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 771</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 772</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 773</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 774</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 775</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 776</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 777</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 778</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 779</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 780</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 781</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 782</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 783</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 784</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 785</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 786</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 787</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 788</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 789</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 790</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 791</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 792</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 793</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 794</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 795</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 796</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 797</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 798</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 799</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 800</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 801</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 802</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 803</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 804</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 805</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 806</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 807</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 808</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 809</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 810</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 811</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 812</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 813</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 814</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 815</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 816</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 817</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 818</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 819</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 820</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 821</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 822</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 823</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 824</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 825</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 826</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 827</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 828</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 829</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 830</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 831</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 832</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 833</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 834</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 835</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 836</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 837</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 838</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 839</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 840</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 841</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 842</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 843</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 844</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 845</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 846</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 847</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 848</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 849</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 850</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 851</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 852</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 853</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 854</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 855</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 856</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 857</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 858</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 859</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 860</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 861</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 862</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 863</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 864</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 865</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 866</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 867</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 868</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 869</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 870</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 871</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 872</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 873</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 874</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 875</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 876</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 877</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 878</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 879</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 880</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 881</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 882</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 883</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 884</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 885</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 886</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 887</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 888</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 889</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 890</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 891</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 892</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 893</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 894</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 895</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 896</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 897</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 898</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 899</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 900</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 901</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 902</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 903</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 904</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 905</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 906</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 907</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 908</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 909</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 910</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 911</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 912</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 913</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 914</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 915</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 916</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 917</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 918</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 919</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 920</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 921</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 922</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 923</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 924</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 925</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 926</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 927</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 928</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 929</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 930</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 931</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 932</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 933</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 934</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 935</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 936</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 937</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 938</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 939</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 940</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 941</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 942</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 943</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 944</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 945</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 946</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 947</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 948</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 949</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 950</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 951</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 952</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 953</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 954</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 955</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 956</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 957</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 958</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 959</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 960</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 961</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 962</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 963</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 964</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 965</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 966</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 967</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 968</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 969</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 970</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 971</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 972</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 973</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 974</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 975</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 976</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 977</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 978</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 979</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 980</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 981</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 982</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 983</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 984</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 985</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 986</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 987</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 988</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 989</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 990</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 991</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 992</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 993</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 994</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 995</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 996</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 997</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 998</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 999</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1000</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1001</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1002</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1003</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1004</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1005</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1006</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1007</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1008</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1009</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1010</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1011</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1012</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1013</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1014</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1015</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1016</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1017</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1018</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1019</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1020</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1021</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1022</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1023</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1024</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1025</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1026</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1027</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1028</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1029</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1030</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1031</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1032</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1033</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1034</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1035</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1036</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1037</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1038</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1039</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1040</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1041</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1042</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1043</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1044</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1045</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1046</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1047</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1048</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1049</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1050</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1051</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1052</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1053</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1054</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1055</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1056</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1057</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1058</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1059</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1060</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1061</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1062</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1063</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1064</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1065</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1066</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1067</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1068</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1069</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1070</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1071</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1072</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1073</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1074</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1075</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1076</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1077</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1078</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1079</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1080</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1081</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1082</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1083</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1084</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1085</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1086</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1087</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1088</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1089</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1090</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1091</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1092</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1093</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1094</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1095</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1096</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1097</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1098</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1099</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">1219</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">class</span> <span style="color: #f0883e; font-weight: bold">Scanner</span><span style="color: #e6edf3">:</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""A class representing a single BBOT scan</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        Create scan with multiple targets:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; my_scan = Scanner("evilcorp.com", "1.2.3.0/24", modules=["portscan", "sslcert", "httpx"])</span>

<span style="color: #a5d6ff">        Create scan with custom config:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; config = {"http_proxy": "http://127.0.0.1:8080", "modules": {"portscan": {"top_ports": 2000}}}</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; my_scan = Scanner("www.evilcorp.com", modules=["portscan", "httpx"], config=config)</span>

<span style="color: #a5d6ff">        Start the scan, iterating over events as they're discovered (synchronous):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; for event in my_scan.start():</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     print(event)</span>

<span style="color: #a5d6ff">        Start the scan, iterating over events as they're discovered (asynchronous):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; async for event in my_scan.async_start():</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt;     print(event)</span>

<span style="color: #a5d6ff">        Start the scan without consuming events (synchronous):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; my_scan.start_without_generator()</span>

<span style="color: #a5d6ff">        Start the scan without consuming events (asynchronous):</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; await my_scan.async_start_without_generator()</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        status (str): Status of scan, representing its current state. It can take on the following string values, each of which is mapped to an integer code in `_status_codes`:</span>
<span style="color: #a5d6ff">            ```markdown</span>
<span style="color: #a5d6ff">            - "NOT_STARTED" (0): Initial status before the scan starts.</span>
<span style="color: #a5d6ff">            - "STARTING" (1): Status when the scan is initializing.</span>
<span style="color: #a5d6ff">            - "RUNNING" (2): Status when the scan is in progress.</span>
<span style="color: #a5d6ff">            - "FINISHING" (3): Status when the scan is in the process of finalizing.</span>
<span style="color: #a5d6ff">            - "CLEANING_UP" (4): Status when the scan is cleaning up resources.</span>
<span style="color: #a5d6ff">            - "ABORTING" (5): Status when the scan is in the process of being aborted.</span>
<span style="color: #a5d6ff">            - "ABORTED" (6): Status when the scan has been aborted.</span>
<span style="color: #a5d6ff">            - "FAILED" (7): Status when the scan has encountered a failure.</span>
<span style="color: #a5d6ff">            - "FINISHED" (8): Status when the scan has successfully completed.</span>
<span style="color: #a5d6ff">            ```</span>
<span style="color: #a5d6ff">        _status_code (int): The numerical representation of the current scan status, stored for internal use. It is mapped according to the values in `_status_codes`.</span>
<span style="color: #a5d6ff">        target (Target): Target of scan (alias to `self.preset.target`).</span>
<span style="color: #a5d6ff">        preset (Preset): The main scan Preset in its baked form.</span>
<span style="color: #a5d6ff">        config (omegaconf.dictconfig.DictConfig): BBOT config (alias to `self.preset.config`).</span>
<span style="color: #a5d6ff">        whitelist (Target): Scan whitelist (by default this is the same as `target`) (alias to `self.preset.whitelist`).</span>
<span style="color: #a5d6ff">        blacklist (Target): Scan blacklist (this takes ultimate precedence) (alias to `self.preset.blacklist`).</span>
<span style="color: #a5d6ff">        helpers (ConfigAwareHelper): Helper containing various reusable functions, regexes, etc. (alias to `self.preset.helpers`).</span>
<span style="color: #a5d6ff">        output_dir (pathlib.Path): Output directory for scan (alias to `self.preset.output_dir`).</span>
<span style="color: #a5d6ff">        name (str): Name of scan (alias to `self.preset.scan_name`).</span>
<span style="color: #a5d6ff">        dispatcher (Dispatcher): Triggers certain events when the scan `status` changes.</span>
<span style="color: #a5d6ff">        modules (dict): Holds all loaded modules in this format: `{"module_name": Module()}`.</span>
<span style="color: #a5d6ff">        stats (ScanStats): Holds high-level scan statistics such as how many events have been produced and consumed by each module.</span>
<span style="color: #a5d6ff">        home (pathlib.Path): Base output directory of the scan (default: `~/.bbot/scans/&lt;scan_name&gt;`).</span>
<span style="color: #a5d6ff">        running (bool): Whether the scan is currently running.</span>
<span style="color: #a5d6ff">        stopping (bool): Whether the scan is currently stopping.</span>
<span style="color: #a5d6ff">        stopped (bool): Whether the scan is currently stopped.</span>
<span style="color: #a5d6ff">        aborting (bool): Whether the scan is aborted or currently aborting.</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        - The status is read-only once set to "ABORTING" until it transitions to "ABORTED."</span>
<span style="color: #a5d6ff">        - Invalid statuses are logged but not applied.</span>
<span style="color: #a5d6ff">        - Setting a status will trigger the `on_status` event in the dispatcher.</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #e6edf3">_status_codes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span>
        <span style="color: #a5d6ff">"NOT_STARTED"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"STARTING"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"RUNNING"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">2</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"FINISHING"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"CLEANING_UP"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">4</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"ABORTING"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"ABORTED"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">6</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"FAILED"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">7</span><span style="color: #e6edf3">,</span>
        <span style="color: #a5d6ff">"FINISHED"</span><span style="color: #e6edf3">:</span> <span style="color: #a5d6ff">8</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">}</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(</span>
        <span style="color: #e6edf3">self,</span>
        <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">targets,</span>
        <span style="color: #e6edf3">scan_id</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
        <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs,</span>
    <span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Initializes the Scanner class.</span>

<span style="color: #a5d6ff">        If a premade `preset` is specified, it will be used for the scan.</span>
<span style="color: #a5d6ff">        Otherwise, `Scan` accepts the same arguments as `Preset`, which are passed through and used to create a new preset.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            *targets (list[str], optional): Scan targets (passed through to `Preset`).</span>
<span style="color: #a5d6ff">            preset (Preset, optional): Preset to use for the scan.</span>
<span style="color: #a5d6ff">            scan_id (str, optional): Unique identifier for the scan. Auto-generates if None.</span>
<span style="color: #a5d6ff">            dispatcher (Dispatcher, optional): Dispatcher object to use. Defaults to new Dispatcher.</span>
<span style="color: #a5d6ff">            **kwargs (list[str], optional): Additional keyword arguments (passed through to `Preset`).</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">scan_id</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(id)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"SCAN:{</span><span style="color: #e6edf3">sha1(rand_string(</span><span style="color: #a5d6ff">20</span><span style="color: #e6edf3">))</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest()</span><span style="color: #a5d6ff">}"</span>

        <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"preset"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"_log"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>

        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.preset</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">Preset</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Preset(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">targets,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">isinstance(preset,</span> <span style="color: #e6edf3">Preset):</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">ValidationError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Preset must be of type Preset, not "{</span><span style="color: #e6edf3">type(preset)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__name__</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bake(self)</span>

        <span style="color: #8b949e; font-style: italic"># scan name</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
            <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">4</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}_{</span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">4</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}"</span>
                    <span style="color: #ff7b72">break</span>
                <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">random_name()</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">home_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">scan_name</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">home_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bbot_home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"scans"</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">scan_name</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">home_path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exists():</span>
                    <span style="color: #ff7b72">break</span>
                <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">1</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_name)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">scan_name</span>

        <span style="color: #8b949e; font-style: italic"># scan output dir</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bbot_home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"scans"</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"NOT_STARTED"</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">OrderedDict({})</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.dispatcher</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">Dispatcher</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Dispatcher()</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dispatcher</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">set_scan(self)</span>

        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.stats</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">ScanStats</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stats</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanStats(self)</span>

        <span style="color: #8b949e; font-style: italic"># scope distance</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"scope"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_search_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">int(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"search_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)))</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_report_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"report_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>

        <span style="color: #8b949e; font-style: italic"># web config</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"web"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_depth"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_links_per_page</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_links_per_page"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">max_redirects</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_max_redirects"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_max_redirects</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max(max_redirects,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_distance)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_proxy</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_proxy"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">httpx_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"httpx_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">httpx_retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"httpx_retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">useragent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"user_agent"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"BBOT"</span><span style="color: #e6edf3">)</span>
        <span style="color: #8b949e; font-style: italic"># custom HTTP headers warning</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_http_headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_http_headers:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span>
                <span style="color: #a5d6ff">"You have enabled custom HTTP headers. These will be attached to all in-scope requests and all requests made by httpx."</span>
            <span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># url file extensions</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_extension_blacklist</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_extension_blacklist"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[]))</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_extension_httpx_only</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_extension_httpx_only"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[]))</span>

        <span style="color: #8b949e; font-style: italic"># url querystring behavior</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_querystring_remove</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_querystring_remove"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># blob inclusion</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_file_blobs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"file_blobs"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_folder_blobs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"folder_blobs"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># how often to print scan status</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_frequency</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"status_frequency"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">15</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prepped</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_finished_init</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanedup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_omitted_event_types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__loop</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_manager_worker_loop_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_strings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__log_handlers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handler_backup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_prep</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Creates the scan's output folder, loads its modules, and calls their .setup() methods.</span>
<span style="color: #a5d6ff">        """</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">mkdir(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prepped:</span>
            <span style="color: #8b949e; font-style: italic"># save scan preset</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">open(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"preset.yml"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"w"</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">f:</span>
                <span style="color: #e6edf3">f</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">write(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">to_yaml())</span>

            <span style="color: #8b949e; font-style: italic"># log scan overview</span>
            <span style="color: #e6edf3">start_msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Scan with {</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules)</span><span style="color: #a5d6ff">:,} modules seeded with {</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target)</span><span style="color: #a5d6ff">:,} targets"</span>
            <span style="color: #e6edf3">details</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelist</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target:</span>
                <span style="color: #e6edf3">details</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelist)</span><span style="color: #a5d6ff">:,} in whitelist"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">blacklist:</span>
                <span style="color: #e6edf3">details</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">blacklist)</span><span style="color: #a5d6ff">:,} in blacklist"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">details:</span>
                <span style="color: #e6edf3">start_msg</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">" ({', '</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(details)</span><span style="color: #a5d6ff">})"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugeinfo(start_msg)</span>

            <span style="color: #8b949e; font-style: italic"># load scan modules (this imports and instantiates them)</span>
            <span style="color: #8b949e; font-style: italic"># up to this point they were only preloaded</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">load_modules()</span>

            <span style="color: #8b949e; font-style: italic"># run each module's .setup() method</span>
            <span style="color: #e6edf3">succeeded,</span> <span style="color: #e6edf3">hard_failed,</span> <span style="color: #e6edf3">soft_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">setup_modules()</span>

            <span style="color: #8b949e; font-style: italic"># intercept modules get sewn together like human centipede</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">intercept_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_intercept]</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i,</span> <span style="color: #e6edf3">intercept_module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">enumerate(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">intercept_modules[</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:]):</span>
                <span style="color: #e6edf3">prev_intercept_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">intercept_modules[i]</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setting intercept module {</span><span style="color: #e6edf3">intercept_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}._incoming_event_queue to previous intercept module {</span><span style="color: #e6edf3">prev_intercept_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}.outgoing_event_queue"</span>
                <span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">intercept_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_incoming_event_queue</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">prev_intercept_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">outgoing_event_queue</span>

            <span style="color: #8b949e; font-style: italic"># abort if there are no output modules</span>
            <span style="color: #e6edf3">num_output_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">len([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_type</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"output"</span><span style="color: #e6edf3">])</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">num_output_modules</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">ScanError(</span><span style="color: #a5d6ff">"Failed to load output modules. Aborting."</span><span style="color: #e6edf3">)</span>
            <span style="color: #8b949e; font-style: italic"># abort if any of the module .setup()s hard-failed (i.e. they errored or returned False)</span>
            <span style="color: #e6edf3">total_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">len(hard_failed</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">soft_failed)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">hard_failed:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup hard-failed for {</span><span style="color: #e6edf3">len(hard_failed)</span><span style="color: #a5d6ff">:,} modules ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(hard_failed)</span><span style="color: #a5d6ff">})"</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>

            <span style="color: #e6edf3">total_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">total_failed</span> <span style="color: #ff7b72; font-weight: bold">+</span> <span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span>
            <span style="color: #e6edf3">success_msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup succeeded for {</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">total_modules</span><span style="color: #a5d6ff">:,} modules."</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">success(success_msg)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prepped</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">start</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">async_to_sync_gen(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">async_start()):</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">event</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">start_without_generator</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">async_to_sync_gen(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">async_start()):</span>
            <span style="color: #ff7b72">pass</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">async_start_without_generator</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">async_start():</span>
            <span style="color: #ff7b72">pass</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">async_start</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">""" """</span>
        <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
        <span style="color: #e6edf3">scan_start_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prep()</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_start_log_handlers()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Ran BBOT {</span><span style="color: #e6edf3">__version__</span><span style="color: #a5d6ff">} at {</span><span style="color: #e6edf3">scan_start_time</span><span style="color: #a5d6ff">}, command: {" "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(sys</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">argv)</span><span style="color: #a5d6ff">}'</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Target: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Preset: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">to_dict(redact_secrets</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No scan targets specified"</span><span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># start status ticker</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_ticker(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_frequency),</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}._status_ticker()"</span>
            <span style="color: #e6edf3">)</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"STARTING"</span>

            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No modules loaded"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FAILED"</span>
                <span style="color: #ff7b72">return</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Starting scan {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">on_start(self)</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"RUNNING"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_start_modules()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span><span style="color: #a5d6ff">:,} modules started"</span><span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># distribute seed events</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">events),</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}.ingress_module.init_events()"</span>
            <span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># main scan loop</span>
            <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                <span style="color: #8b949e; font-style: italic"># abort if we're aborting</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aborting:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
                    <span style="color: #ff7b72">break</span>

                <span style="color: #8b949e; font-style: italic"># yield events as they come (async for event in scan.async_start())</span>
                <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"python"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
                    <span style="color: #e6edf3">events,</span> <span style="color: #e6edf3">finish</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[</span><span style="color: #a5d6ff">"python"</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_events_waiting(batch_size</span><span style="color: #ff7b72; font-weight: bold">=-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">events:</span>
                        <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">e</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">events:</span>
                        <span style="color: #ff7b72">continue</span>

                <span style="color: #8b949e; font-style: italic"># break if initialization finished and the scan is no longer active</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_finished_init</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules_finished:</span>
                    <span style="color: #e6edf3">new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finish()</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">new_activity:</span>
                        <span style="color: #ff7b72">break</span>

                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(</span><span style="color: #a5d6ff">0.1</span><span style="color: #e6edf3">)</span>

            <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>

        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_exception_chain(e,</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">KeyboardInterrupt</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CancelledError)):</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stop()</span>
                <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #ff7b72">raise</span>
                <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">ScanError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

                <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">BBOTError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error during scan: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unexpected error during scan:</span><span style="color: #79c0ff">\n</span><span style="color: #a5d6ff">{</span><span style="color: #e6edf3">traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc()</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cancel_tasks()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Awaiting {</span><span style="color: #e6edf3">len(tasks)</span><span style="color: #a5d6ff">:,} tasks"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks:</span>
                <span style="color: #8b949e; font-style: italic"># self.debug(f"Awaiting {task}")</span>
                <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">):</span>
                    <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wait_for(task,</span> <span style="color: #e6edf3">timeout</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">0.1</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Awaited {</span><span style="color: #e6edf3">len(tasks)</span><span style="color: #a5d6ff">:,} tasks"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_report()</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanup()</span>

            <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"ABORTING"</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"ABORTED"</span>
                <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugewarning</span>
            <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">failed:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FAILED"</span>
                <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FINISHED"</span>

            <span style="color: #e6edf3">scan_run_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">scan_start_time</span>
            <span style="color: #e6edf3">scan_run_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">human_timedelta(scan_run_time)</span>
            <span style="color: #e6edf3">log_fn(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Scan {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">} completed in {</span><span style="color: #e6edf3">scan_run_time</span><span style="color: #a5d6ff">} with status {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">on_finish(self)</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stop_log_handlers()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_start_modules</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Starting module worker loops"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
            <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">start()</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">setup_modules</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">remove_failed</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Asynchronously initializes all loaded modules by invoking their `setup()` methods.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            remove_failed (bool): Flag indicating whether to remove modules that fail setup.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            tuple:</span>
<span style="color: #a5d6ff">                succeeded - List of modules that successfully set up.</span>
<span style="color: #a5d6ff">                hard_failed - List of modules that encountered a hard failure during setup.</span>
<span style="color: #a5d6ff">                soft_failed - List of modules that encountered a soft failure during setup.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            ScanError: If no output modules could be loaded.</span>

<span style="color: #a5d6ff">        Notes:</span>
<span style="color: #a5d6ff">            Hard-failed modules are set to an error state and removed if `remove_failed` is True.</span>
<span style="color: #a5d6ff">            Soft-failed modules are not set to an error state but are also removed if `remove_failed` is True.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">load_modules()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setting up modules"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">succeeded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">hard_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #e6edf3">soft_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">as_completed([m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_setup()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()]):</span>
            <span style="color: #e6edf3">module,</span> <span style="color: #e6edf3">status,</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup succeeded for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">} ({</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">succeeded</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
            <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup hard-failed for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">set_error_state()</span>
                <span style="color: #e6edf3">hard_failed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup soft-failed for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">soft_failed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">status)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_intercept</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">remove_failed):</span>
                <span style="color: #8b949e; font-style: italic"># if a intercept module fails setup, we always remove it</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">succeeded,</span> <span style="color: #e6edf3">hard_failed,</span> <span style="color: #e6edf3">soft_failed</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">load_modules</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Asynchronously import and instantiate all scan modules, including internal and output modules.</span>

<span style="color: #a5d6ff">        This method is automatically invoked by `setup_modules()`. It performs several key tasks in the following sequence:</span>

<span style="color: #a5d6ff">        1. Install dependencies for each module via `self.helpers.depsinstaller.install()`.</span>
<span style="color: #a5d6ff">        2. Load scan modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">        3. Load internal modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">        4. Load output modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">        5. Sorts modules based on their `_priority` attribute.</span>

<span style="color: #a5d6ff">        If any modules fail to load or their dependencies fail to install, a ScanError will be raised (unless `self.force_start` is True).</span>

<span style="color: #a5d6ff">        Attributes:</span>
<span style="color: #a5d6ff">            succeeded, failed (tuple): A tuple containing lists of modules that succeeded or failed during the dependency installation.</span>
<span style="color: #a5d6ff">            loaded_modules, loaded_internal_modules, loaded_output_modules (dict): Dictionaries of successfully loaded modules.</span>
<span style="color: #a5d6ff">            failed, failed_internal, failed_output (list): Lists of module names that failed to load.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            ScanError: If any module dependencies fail to install or modules fail to load, and if `self.force_start` is False.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            After all modules are loaded, they are sorted by `_priority` and stored in the `modules` dictionary.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No modules to load"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">return</span>

            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No scan modules to load"</span><span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># install module dependencies</span>
            <span style="color: #e6edf3">succeeded,</span> <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">depsinstaller</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">install(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">failed:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to install dependencies for {</span><span style="color: #e6edf3">len(failed)</span><span style="color: #a5d6ff">:,} modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed)</span><span style="color: #a5d6ff">}"</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
            <span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>
            <span style="color: #e6edf3">output_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>
            <span style="color: #e6edf3">internal_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">internal_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>

            <span style="color: #8b949e; font-style: italic"># Load scan modules</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(modules)</span><span style="color: #a5d6ff">:,} scan modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">loaded_modules,</span> <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(modules)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_modules)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(failed)</span><span style="color: #a5d6ff">:,} scan modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed)</span><span style="color: #a5d6ff">}"</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules)</span><span style="color: #a5d6ff">:,} scan modules ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_modules)</span><span style="color: #a5d6ff">})"</span>
                <span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># Load internal modules</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(internal_modules)</span><span style="color: #a5d6ff">:,} internal modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(internal_modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">loaded_internal_modules,</span> <span style="color: #e6edf3">failed_internal</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(internal_modules)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_internal_modules)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed_internal)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(loaded_internal_modules)</span><span style="color: #a5d6ff">:,} internal modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_internal_modules)</span><span style="color: #a5d6ff">}"</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_internal_modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_internal_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">internal_modules)</span><span style="color: #a5d6ff">:,} internal modules ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_internal_modules)</span><span style="color: #a5d6ff">})"</span>
                <span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># Load output modules</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(output_modules)</span><span style="color: #a5d6ff">:,} output modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(output_modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">loaded_output_modules,</span> <span style="color: #e6edf3">failed_output</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(output_modules)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_output_modules)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed_output)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(failed_output)</span><span style="color: #a5d6ff">:,} output modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed_output)</span><span style="color: #a5d6ff">}"</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_output_modules:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_output_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_modules)</span><span style="color: #a5d6ff">:,} output modules, ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_output_modules)</span><span style="color: #a5d6ff">})"</span>
                <span style="color: #e6edf3">)</span>

            <span style="color: #8b949e; font-style: italic"># builtin intercept modules</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanIngress(self)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanEgress(self)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span>

            <span style="color: #8b949e; font-style: italic"># sort modules by priority</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">OrderedDict(sorted(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items(),</span> <span style="color: #e6edf3">key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">getattr(x[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">],</span> <span style="color: #a5d6ff">"priority"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)))</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">modules_finished</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #e6edf3">finished_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finished</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()]</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">all(finished_modules)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">kill_module</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">module_name,</span> <span style="color: #e6edf3">message</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">signal</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">SIGINT</span>

        <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[module_name]</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_intercept:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Cannot kill module "{</span><span style="color: #e6edf3">module_name</span><span style="color: #a5d6ff">}" because it is critical to the scan'</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span>
        <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">set_error_state(message</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">message,</span> <span style="color: #e6edf3">clear_outgoing_queue</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">proc</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_proc_tracker:</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
                <span style="color: #e6edf3">proc</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">send_signal(SIGINT)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel_tasks_sync(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_tasks)</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">incoming_event_queues</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">incoming_queues</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">num_queued_events</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #e6edf3">total</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">q</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">incoming_event_queues:</span>
            <span style="color: #e6edf3">total</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">len(q</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_queue)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">total</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">modules_status</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">_log</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">finished</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
        <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"modules"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">{}}</span>

        <span style="color: #e6edf3">sorted_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module_name,</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">module_name</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">startswith(</span><span style="color: #a5d6ff">"_"</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">continue</span>
            <span style="color: #e6edf3">sorted_modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module)</span>
            <span style="color: #e6edf3">mod_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">mod_status[</span><span style="color: #a5d6ff">"running"</span><span style="color: #e6edf3">]:</span>
                <span style="color: #e6edf3">finished</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
            <span style="color: #e6edf3">status[</span><span style="color: #a5d6ff">"modules"</span><span style="color: #e6edf3">][module_name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">mod_status</span>

        <span style="color: #8b949e; font-style: italic"># sort modules by name</span>
        <span style="color: #e6edf3">sorted_modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sort(key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">m:</span> <span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>

        <span style="color: #e6edf3">status[</span><span style="color: #a5d6ff">"finished"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">finished</span>

        <span style="color: #e6edf3">modules_errored</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m,</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">status[</span><span style="color: #a5d6ff">"modules"</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items()</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">s[</span><span style="color: #a5d6ff">"errored"</span><span style="color: #e6edf3">]]</span>

        <span style="color: #e6edf3">max_mem_percent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">90</span>
        <span style="color: #e6edf3">mem_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">memory_status()</span>
        <span style="color: #8b949e; font-style: italic"># abort if we don't have the memory</span>
        <span style="color: #e6edf3">mem_percent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">mem_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">percent</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">mem_percent</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #e6edf3">max_mem_percent:</span>
            <span style="color: #e6edf3">free_memory</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">mem_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">available</span>
            <span style="color: #e6edf3">free_memory_human</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bytes_to_human(free_memory)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"System memory is at {</span><span style="color: #e6edf3">mem_percent</span><span style="color: #a5d6ff">:.1f}% ({</span><span style="color: #e6edf3">free_memory_human</span><span style="color: #a5d6ff">} remaining)"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">_log:</span>
            <span style="color: #e6edf3">modules_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m,</span> <span style="color: #e6edf3">s</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">status[</span><span style="color: #a5d6ff">"modules"</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
                <span style="color: #e6edf3">running</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[</span><span style="color: #a5d6ff">"running"</span><span style="color: #e6edf3">]</span>
                <span style="color: #e6edf3">incoming</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[</span><span style="color: #a5d6ff">"events"</span><span style="color: #e6edf3">][</span><span style="color: #a5d6ff">"incoming"</span><span style="color: #e6edf3">]</span>
                <span style="color: #e6edf3">outgoing</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[</span><span style="color: #a5d6ff">"events"</span><span style="color: #e6edf3">][</span><span style="color: #a5d6ff">"outgoing"</span><span style="color: #e6edf3">]</span>
                <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">s[</span><span style="color: #a5d6ff">"tasks"</span><span style="color: #e6edf3">]</span>
                <span style="color: #e6edf3">total</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sum([incoming,</span> <span style="color: #e6edf3">outgoing,</span> <span style="color: #e6edf3">tasks])</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">running</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">total</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">modules_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((m,</span> <span style="color: #e6edf3">running,</span> <span style="color: #e6edf3">incoming,</span> <span style="color: #e6edf3">outgoing,</span> <span style="color: #e6edf3">tasks,</span> <span style="color: #e6edf3">total))</span>
            <span style="color: #e6edf3">modules_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sort(key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">reverse</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">modules_status:</span>
                <span style="color: #e6edf3">modules_status_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">", "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">m</span><span style="color: #a5d6ff">}({</span><span style="color: #e6edf3">i</span><span style="color: #a5d6ff">:,}:{</span><span style="color: #e6edf3">t</span><span style="color: #a5d6ff">:,}:{</span><span style="color: #e6edf3">o</span><span style="color: #a5d6ff">:,})"</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m,</span> <span style="color: #e6edf3">r,</span> <span style="color: #e6edf3">i,</span> <span style="color: #e6edf3">o,</span> <span style="color: #e6edf3">t,</span> <span style="color: #e6edf3">_</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">modules_status])</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: Modules running (incoming:processing:outgoing) {</span><span style="color: #e6edf3">modules_status_str</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: No modules running"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">event_type_summary</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stats</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">events_emitted_by_type</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items(),</span> <span style="color: #e6edf3">key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">reverse</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">event_type_summary:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: Events produced so far: {", "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">k</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">v</span><span style="color: #a5d6ff">}"</span><span style="color: #6e7681"> </span><span style="color: #ff7b72">for</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">k,v</span><span style="color: #6e7681"> </span><span style="color: #ff7b72; font-weight: bold">in</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">event_type_summary])</span><span style="color: #a5d6ff">}'</span>
                <span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: No events produced yet"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">modules_errored:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: Modules errored: {</span><span style="color: #e6edf3">len(modules_errored)</span><span style="color: #a5d6ff">:,} ({", "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join([m</span><span style="color: #6e7681"> </span><span style="color: #ff7b72">for</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">m</span><span style="color: #6e7681"> </span><span style="color: #ff7b72; font-weight: bold">in</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">modules_errored])</span><span style="color: #a5d6ff">})'</span>
                <span style="color: #e6edf3">)</span>

            <span style="color: #e6edf3">num_queued_events</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">num_queued_events</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">num_queued_events:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">num_queued_events</span><span style="color: #a5d6ff">:,} events in queue ({</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stats</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">speedometer</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">speed</span><span style="color: #a5d6ff">:,} processed in the past minute)"</span>
                <span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                    <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: No events in queue ({</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stats</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">speedometer</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">speed</span><span style="color: #a5d6ff">:,} processed in the past minute)"</span>
                <span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">log_level</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEBUG:</span>
                <span style="color: #8b949e; font-style: italic"># status debugging</span>
                <span style="color: #e6edf3">scan_active_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
                <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"scan._finished_init: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_finished_init</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"scan.modules_finished: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules_finished</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">sorted_modules:</span>
                    <span style="color: #e6edf3">running</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">running</span>
                    <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"    {</span><span style="color: #e6edf3">m</span><span style="color: #a5d6ff">}.finished: {</span><span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finished</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"        running: {</span><span style="color: #e6edf3">running</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">running:</span>
                        <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"        tasks:"</span><span style="color: #e6edf3">)</span>
                        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">list(m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_task_counter</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()):</span>
                            <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"            - {</span><span style="color: #e6edf3">task</span><span style="color: #a5d6ff">}:"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"        incoming_queue_size: {</span><span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">num_incoming_events</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">scan_active_status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"        outgoing_queue_size: {</span><span style="color: #e6edf3">m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">outgoing_event_queue</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">qsize()</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">line</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">scan_active_status:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(line)</span>

                <span style="color: #8b949e; font-style: italic"># log module memory usage</span>
                <span style="color: #e6edf3">module_memory_usage</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">sorted_modules:</span>
                    <span style="color: #e6edf3">memory_usage</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">memory_usage</span>
                    <span style="color: #e6edf3">module_memory_usage</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append((module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name,</span> <span style="color: #e6edf3">memory_usage))</span>
                <span style="color: #e6edf3">module_memory_usage</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sort(key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">reverse</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"MODULE MEMORY USAGE:"</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module_name,</span> <span style="color: #e6edf3">usage</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">module_memory_usage:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"    - {</span><span style="color: #e6edf3">module_name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bytes_to_human(usage)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({</span><span style="color: #a5d6ff">"modules_errored"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">len(modules_errored)})</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">status</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">stop</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Stops the in-progress scan and performs necessary cleanup.</span>

<span style="color: #a5d6ff">        This method sets the scan's status to "ABORTING," cancels any pending tasks, and drains event queues. It also kills child processes spawned during the scan.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"ABORTING"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugewarning(</span><span style="color: #a5d6ff">"Aborting scan"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cancel_tasks()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">kill_children()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">kill_children()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Finished aborting scan"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">finish</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Finalizes the scan by invoking the `finished()` method on all active modules if new activity is detected.</span>

<span style="color: #a5d6ff">        The method is idempotent and will return False if no new activity has been recorded since the last invocation.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            bool: True if new activity has been detected and the `finished()` method is invoked on all modules.</span>
<span style="color: #a5d6ff">                  False if no new activity has been detected since the last invocation.</span>

<span style="color: #a5d6ff">        Notes:</span>
<span style="color: #a5d6ff">            This method alters the scan's status to "FINISHING" if new activity is detected.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #8b949e; font-style: italic"># if new events were generated since last time we were here</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FINISHING"</span>
            <span style="color: #8b949e; font-style: italic"># Trigger .finished() on every module and start over</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #a5d6ff">"Finishing scan"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
                <span style="color: #e6edf3">finished_event</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">make_event(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FINISHED"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"FINISHED"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">dummy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">tags</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name})</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">queue_event(finished_event)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Completed finish()"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
        <span style="color: #8b949e; font-style: italic"># Return False if no new events were generated since last time</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Completed final finish()"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_drain_queues</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Empties all the event queues for each loaded module and the manager's incoming event queue.</span>

<span style="color: #a5d6ff">        This method iteratively empties both the incoming and outgoing event queues of each module, as well as the incoming event queue of the scan manager.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Draining queues"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">queues</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">QueueEmpty):</span>
                <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">incoming_event_queue:</span>
                        <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">incoming_event_queue</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get_nowait()</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">queues</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">QueueEmpty):</span>
                <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">outgoing_event_queue:</span>
                        <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">outgoing_event_queue</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get_nowait()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Finished draining queues"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_cancel_tasks</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Cancels all asynchronous tasks and shuts down the process pool.</span>

<span style="color: #a5d6ff">        This method collects all pending tasks from each module, the dispatcher,</span>
<span style="color: #a5d6ff">        and the scan manager. After collecting these tasks, it cancels them synchronously</span>
<span style="color: #a5d6ff">        using a helper function. Finally, it shuts down the process pool, canceling any</span>
<span style="color: #a5d6ff">        pending futures.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Cancelling all scan tasks"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #8b949e; font-style: italic"># module workers</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
            <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">getattr(m,</span> <span style="color: #a5d6ff">"_tasks"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[])</span>
        <span style="color: #8b949e; font-style: italic"># init events</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task:</span>
            <span style="color: #e6edf3">tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task)</span>
        <span style="color: #8b949e; font-style: italic"># ticker</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task:</span>
            <span style="color: #e6edf3">tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task)</span>
        <span style="color: #8b949e; font-style: italic"># dispatcher</span>
        <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher_tasks</span>
        <span style="color: #8b949e; font-style: italic"># manager worker loops</span>
        <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_manager_worker_loop_tasks</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">cancel_tasks_sync(tasks)</span>
        <span style="color: #8b949e; font-style: italic"># process pool</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">process_pool</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">shutdown(cancel_futures</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Finished cancelling all scan tasks"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">tasks</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_report</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Asynchronously executes the `report()` method for each module in the scan.</span>

<span style="color: #a5d6ff">        This method is called once at the end of each scan and is responsible for</span>
<span style="color: #a5d6ff">        triggering the `report()` function for each module. It executes irrespective</span>
<span style="color: #a5d6ff">        of whether the scan was aborted or completed successfully. The method makes</span>
<span style="color: #a5d6ff">        use of an asynchronous context manager (`_acatch`) to handle exceptions and</span>
<span style="color: #a5d6ff">        a task counter to keep track of the task's context.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">mod</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
            <span style="color: #e6edf3">context</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">mod</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}.report()"</span>
            <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_acatch(context),</span> <span style="color: #e6edf3">mod</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_task_counter</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">count(context):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">mod</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">report()</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_cleanup</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""Asynchronously executes the `cleanup()` method for each module in the scan.</span>

<span style="color: #a5d6ff">        This method is called once at the end of the scan to perform resource cleanup</span>
<span style="color: #a5d6ff">        tasks. It is executed regardless of whether the scan was aborted or completed</span>
<span style="color: #a5d6ff">        successfully. The scan status is set to "CLEANING_UP" during the execution.</span>
<span style="color: #a5d6ff">        After calling the `cleanup()` method for each module, it performs additional</span>
<span style="color: #a5d6ff">        cleanup tasks such as removing the scan's home directory if empty and cleaning</span>
<span style="color: #a5d6ff">        old scans.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            None</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #8b949e; font-style: italic"># clean up self</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanedup:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanedup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"CLEANING_UP"</span>
            <span style="color: #8b949e; font-style: italic"># clean up dns engine</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">shutdown()</span>
            <span style="color: #8b949e; font-style: italic"># clean up web engine</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_web</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">shutdown()</span>
            <span style="color: #8b949e; font-style: italic"># clean up modules</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">mod</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">mod</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanup()</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rmdir()</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">clean_old_scans()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">in_scope</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_scope(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">whitelisted</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelisted(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">blacklisted</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">blacklisted(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">core</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">config</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">target</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">whitelist</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelist</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">blacklist</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">blacklist</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">helpers</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">force_start</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">force_start</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">word_cloud</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">word_cloud</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">stopping</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">running</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">stopped</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">5</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">running</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">0</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">&lt;</span> <span style="color: #a5d6ff">4</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">aborting</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #a5d6ff">5</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">&lt;=</span> <span style="color: #a5d6ff">6</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">status</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">omitted_event_types</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_omitted_event_types</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_omitted_event_types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"omit_event_types"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[])</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_omitted_event_types</span>

    <span style="color: #d2a8ff; font-weight: bold">@status</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">setter</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">status</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">status):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Block setting after status has been aborted</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(status)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">strip()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">upper()</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_codes:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"ABORTING"</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"ABORTED"</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Attempt to set invalid status "{</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">}" on aborted scan'</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">status</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_codes[status]</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher_tasks</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(</span>
                        <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(</span>
                            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">catch(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">on_status,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id),</span>
                            <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}.dispatcher.on_status({</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">,</span>
                        <span style="color: #e6edf3">)</span>
                    <span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Scan status is already "{</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Attempt to set invalid status "{</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">}" on scan'</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">make_event</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"scan"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span>
        <span style="color: #e6edf3">event</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">make_event(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">event</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">root_event</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        The root scan event, e.g.:</span>
<span style="color: #a5d6ff">            ```json</span>
<span style="color: #a5d6ff">            {</span>
<span style="color: #a5d6ff">              "type": "SCAN",</span>
<span style="color: #a5d6ff">              "id": "SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54",</span>
<span style="color: #a5d6ff">              "data": "pixilated_kathryn (SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54)",</span>
<span style="color: #a5d6ff">              "scope_distance": 0,</span>
<span style="color: #a5d6ff">              "scan": "SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54",</span>
<span style="color: #a5d6ff">              "timestamp": 1694548779.616255,</span>
<span style="color: #a5d6ff">              "parent": "SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54",</span>
<span style="color: #a5d6ff">              "tags": [</span>
<span style="color: #a5d6ff">                "distance-0"</span>
<span style="color: #a5d6ff">              ],</span>
<span style="color: #a5d6ff">              "module": "TARGET",</span>
<span style="color: #a5d6ff">              "module_sequence": "TARGET"</span>
<span style="color: #a5d6ff">            }</span>
<span style="color: #a5d6ff">            ```</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">root_event</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">make_event(data</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json,</span> <span style="color: #e6edf3">event_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"SCAN"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">dummy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id</span>
        <span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
        <span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">root_event</span>
        <span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_make_dummy_module(name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"TARGET"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"TARGET"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">discovery_context</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Scan {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">} started at {</span><span style="color: #e6edf3">root_event</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timestamp</span><span style="color: #a5d6ff">}"</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">root_event</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">dns_strings</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        A list of DNS hostname strings generated from the scan target</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_strings</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dns_targets</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">isinstance(t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">str))</span>
            <span style="color: #e6edf3">dns_whitelist</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">whitelist</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">isinstance(t</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">host,</span> <span style="color: #e6edf3">str))</span>
            <span style="color: #e6edf3">dns_targets</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(dns_whitelist)</span>
            <span style="color: #e6edf3">dns_targets</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted(dns_targets,</span> <span style="color: #e6edf3">key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">len)</span>
            <span style="color: #e6edf3">dns_targets_set</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
            <span style="color: #e6edf3">dns_strings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
            <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_targets:</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">any(x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">dns_targets_set</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">x</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">domain_parents(t,</span> <span style="color: #e6edf3">include_self</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)):</span>
                    <span style="color: #e6edf3">dns_strings</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(t)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_strings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns_strings</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_strings</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_generate_dns_regexes</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">pattern):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Generates a list of compiled DNS hostname regexes based on the provided pattern.</span>
<span style="color: #a5d6ff">        This method centralizes the regex compilation to avoid redundancy in the dns_regexes and dns_regexes_yara methods.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            pattern (str):</span>
<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            list[re.Pattern]: A list of compiled regex patterns if enabled, otherwise an empty list.</span>
<span style="color: #a5d6ff">        """</span>

        <span style="color: #e6edf3">dns_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">t</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_strings:</span>
            <span style="color: #e6edf3">regex_pattern</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">compile(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">pattern</span><span style="color: #a5d6ff">}{</span><span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">escape(t)</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">re</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">I)</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Generated Regex [{</span><span style="color: #e6edf3">regex_pattern</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pattern</span><span style="color: #a5d6ff">}] for domain {</span><span style="color: #e6edf3">t</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">dns_regexes</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(regex_pattern)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">dns_regexes</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">dns_regexes</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        A list of DNS hostname regexes generated from the scan target</span>
<span style="color: #a5d6ff">        For the purpose of extracting hostnames</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            Extract hostnames from text:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; for regex in scan.dns_regexes:</span>
<span style="color: #a5d6ff">            ...     for match in regex.finditer(response.text):</span>
<span style="color: #a5d6ff">            ...         hostname = match.group().lower()</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_regexes:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_generate_dns_regexes(</span><span style="color: #79c0ff">r</span><span style="color: #a5d6ff">"((?:(?:[\w-]+)\.)+"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_regexes</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">dns_regexes_yara</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Returns a list of DNS hostname regexes formatted specifically for compatibility with YARA rules.</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_generate_dns_regexes(</span><span style="color: #79c0ff">r</span><span style="color: #a5d6ff">"(([a-z0-9-]+\.)+"</span><span style="color: #e6edf3">)</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">json</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        A dictionary representation of the scan including its name, ID, targets, whitelist, blacklist, and modules</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #e6edf3">j</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dict()</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">i</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"id"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"name"</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">v</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">getattr(self,</span> <span style="color: #e6edf3">i,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">v:</span>
                <span style="color: #e6edf3">j</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update({i:</span> <span style="color: #e6edf3">v})</span>
        <span style="color: #e6edf3">j[</span><span style="color: #a5d6ff">"target"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json</span>
        <span style="color: #e6edf3">j[</span><span style="color: #a5d6ff">"preset"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">to_dict(redact_secrets</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">j</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">debug</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">verbose</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">hugeverbose</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugeverbose(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">info</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">hugeinfo</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugeinfo(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">success</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">success(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">hugesuccess</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">warning</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">hugewarning</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugewarning(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">error</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">trace</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">msg</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">e_type,</span> <span style="color: #e6edf3">e_val,</span> <span style="color: #e6edf3">e_traceback</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">exc_info()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">e_type</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc())</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(msg)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">critical</span><span style="color: #e6edf3">(self,</span> <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">trace</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">args,</span> <span style="color: #e6edf3">extra</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"scan_id"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id},</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">trace:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">log_level</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Return the current log level, e.g. logging.INFO</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">log_level</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_log_handlers</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__log_handlers</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">mkdir(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home)</span>
            <span style="color: #e6edf3">main_handler</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">handlers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">TimedRotatingFileHandler(</span>
                <span style="color: #e6edf3">str(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"scan.log"</span><span style="color: #e6edf3">),</span> <span style="color: #e6edf3">when</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"d"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">interval</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">backupCount</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">14</span>
            <span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">main_handler</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">addFilter(</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">levelno</span> <span style="color: #ff7b72; font-weight: bold">!=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">TRACE</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">levelno</span> <span style="color: #ff7b72; font-weight: bold">&gt;=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">VERBOSE)</span>
            <span style="color: #e6edf3">debug_handler</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">handlers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">TimedRotatingFileHandler(</span>
                <span style="color: #e6edf3">str(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"debug.log"</span><span style="color: #e6edf3">),</span> <span style="color: #e6edf3">when</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"d"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">interval</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">backupCount</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">14</span>
            <span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">debug_handler</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">addFilter(</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">x</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">levelno</span> <span style="color: #ff7b72; font-weight: bold">&gt;=</span> <span style="color: #e6edf3">logging</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">DEBUG)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__log_handlers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[main_handler,</span> <span style="color: #e6edf3">debug_handler]</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__log_handlers</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_start_log_handlers</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #8b949e; font-style: italic"># add log handlers</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handlers:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_log_handler(handler)</span>
        <span style="color: #8b949e; font-style: italic"># temporarily disable main ones</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">handler_name</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"file_main"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"file_debug"</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">log_handlers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(handler_name,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handler_backup:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handler_backup</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(handler)</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">remove_log_handler(handler)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_stop_log_handlers</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #8b949e; font-style: italic"># remove log handlers</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handlers:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">remove_log_handler(handler)</span>
        <span style="color: #8b949e; font-style: italic"># restore main ones</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">handler</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handler_backup:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">core</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">logger</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add_log_handler(handler)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_fail_setup</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">msg):</span>
        <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(msg)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">force_start:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(msg)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">" (--force to run module anyway)"</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">ScanError(msg)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_load_modules</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">modules):</span>
        <span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[str(m)</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">modules]</span>
        <span style="color: #e6edf3">loaded_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>
        <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set()</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module_name,</span> <span style="color: #e6edf3">module_class</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">module_loader</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">load_modules(modules)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items():</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">module_class:</span>
                <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">loaded_modules[module_name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">module_class(self)</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Loaded module "{</span><span style="color: #e6edf3">module_name</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
                    <span style="color: #ff7b72">continue</span>
                <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
                    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load module {</span><span style="color: #e6edf3">module_class</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Failed to load unknown module "{</span><span style="color: #e6edf3">module_name</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">failed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">add(module_name)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">loaded_modules,</span> <span style="color: #e6edf3">failed</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_status_ticker</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">interval</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">15</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_acatch():</span>
            <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(interval)</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules_status(_log</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>

    <span style="color: #d2a8ff; font-weight: bold">@contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">asynccontextmanager</span>
    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_acatch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">context</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"scan"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">finally_callback</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">unhandled_is_critical</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Async version of catch()</span>

<span style="color: #a5d6ff">        async with catch():</span>
<span style="color: #a5d6ff">            await do_stuff()</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">yield</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_handle_exception(e,</span> <span style="color: #e6edf3">context</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">context,</span> <span style="color: #e6edf3">unhandled_is_critical</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">unhandled_is_critical)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_handle_exception</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">e,</span> <span style="color: #e6edf3">context</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"scan"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">finally_callback</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">unhandled_is_critical</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">callable(context):</span>
            <span style="color: #e6edf3">context</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">context</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__qualname__</span><span style="color: #a5d6ff">}()"</span>
        <span style="color: #e6edf3">filename,</span> <span style="color: #e6edf3">lineno,</span> <span style="color: #e6edf3">funcname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get_traceback_details(e)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_exception_chain(e,</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">KeyboardInterrupt</span><span style="color: #e6edf3">,)):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Interrupted"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stop()</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #f0883e; font-weight: bold">BrokenPipeError</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"BrokenPipeError in {</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">lineno</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">funcname</span><span style="color: #a5d6ff">}(): {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CancelledError):</span>
            <span style="color: #ff7b72">raise</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">isinstance(e,</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">):</span>
            <span style="color: #e6edf3">traceback_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">getattr(e,</span> <span style="color: #a5d6ff">"engine_traceback"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">traceback_str</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">traceback_str</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">unhandled_is_critical:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error in {</span><span style="color: #e6edf3">context</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">lineno</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">funcname</span><span style="color: #a5d6ff">}(): {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(traceback_str)</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error in {</span><span style="color: #e6edf3">context</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">filename</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">lineno</span><span style="color: #a5d6ff">}:{</span><span style="color: #e6edf3">funcname</span><span style="color: #a5d6ff">}(): {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
                <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(traceback_str)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">callable(finally_callback):</span>
            <span style="color: #e6edf3">finally_callback(e)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_make_dummy_module</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">name,</span> <span style="color: #e6edf3">_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"scan"</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Construct a dummy module, for attachment to events</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules[name]</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dummy</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">DummyModule(scan</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">self,</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">name,</span> <span style="color: #e6edf3">_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">_type)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules[name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dummy</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">dummy</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_make_dummy_module_dns</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">name):</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dummy_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules[name]</span>
        <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">KeyError</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">dummy_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_make_dummy_module(name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">name,</span> <span style="color: #e6edf3">_type</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"DNS"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">dummy_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress_dupes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
            <span style="color: #e6edf3">dummy_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_priority</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">4</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules[name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dummy_module</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">dummy_module</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.dns_regexes">
<span class="doc doc-object-name doc-attribute-name">dns_regexes</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">dns_regexes</span>
</code></pre></div>
<div class="doc doc-contents">
<p>A list of DNS hostname regexes generated from the scan target
For the purpose of extracting hostnames</p>
<p><span class="doc-section-title">Examples:</span></p>
<p>Extract hostnames from text:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #ff7b72">for</span> <span style="color: #e6edf3">regex</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">scan</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_regexes:</span>
<span style="color: #8b949e">... </span>    <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">match</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">regex</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finditer(response</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">text):</span>
<span style="color: #8b949e">... </span>        <span style="color: #e6edf3">hostname</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">match</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">group()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span>
</code></pre></div>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.dns_regexes_yara">
<span class="doc doc-object-name doc-attribute-name">dns_regexes_yara</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">dns_regexes_yara</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Returns a list of DNS hostname regexes formatted specifically for compatibility with YARA rules.</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.dns_strings">
<span class="doc doc-object-name doc-attribute-name">dns_strings</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">dns_strings</span>
</code></pre></div>
<div class="doc doc-contents">
<p>A list of DNS hostname strings generated from the scan target</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.json">
<span class="doc doc-object-name doc-attribute-name">json</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">json</span>
</code></pre></div>
<div class="doc doc-contents">
<p>A dictionary representation of the scan including its name, ID, targets, whitelist, blacklist, and modules</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.log_level">
<span class="doc doc-object-name doc-attribute-name">log_level</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">log_level</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Return the current log level, e.g. logging.INFO</p>
</div>
</div>
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.root_event">
<span class="doc doc-object-name doc-attribute-name">root_event</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-property"><code>property</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">root_event</span>
</code></pre></div>
<div class="doc doc-contents">
<p>The root scan event, e.g.:
    <div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">{</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"type"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"SCAN"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"id"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"data"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"pixilated_kathryn (SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54)"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"scope_distance"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"scan"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"timestamp"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">1694548779.616255</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"parent"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"SCAN:1188928d942ace8e3befae0bdb9c3caa22705f54"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"tags"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #e6edf3">[</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"distance-0"</span>
<span style="color: #6e7681">  </span><span style="color: #e6edf3">],</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"module"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"TARGET"</span><span style="color: #e6edf3">,</span>
<span style="color: #6e7681">  </span><span style="color: #7ee787">"module_sequence"</span><span style="color: #e6edf3">:</span><span style="color: #6e7681"> </span><span style="color: #a5d6ff">"TARGET"</span>
<span style="color: #e6edf3">}</span>
</code></pre></div></p>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.__init__">
<span class="doc doc-object-name doc-function-name">__init__</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">targets,</span> <span style="color: #e6edf3">scan_id</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Initializes the Scanner class.</p>
<p>If a premade <code>preset</code> is specified, it will be used for the scan.
Otherwise, <code>Scan</code> accepts the same arguments as <code>Preset</code>, which are passed through and used to create a new preset.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>*targets</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>, default:
                  <code>()</code>
)
          –
          <div class="doc-md-description">
<p>Scan targets (passed through to <code>Preset</code>).</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>preset</code></b>
              (<code><a class="autorefs autorefs-internal" title="bbot.scanner.preset.Preset" href="../presets/#bbot.scanner.Preset">Preset</a></code>)
          –
          <div class="doc-md-description">
<p>Preset to use for the scan.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>scan_id</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
<p>Unique identifier for the scan. Auto-generates if None.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>dispatcher</code></b>
              (<code><span title="bbot.scanner.dispatcher.Dispatcher">Dispatcher</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
<p>Dispatcher object to use. Defaults to new Dispatcher.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>**kwargs</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a>]</code>, default:
                  <code>{}</code>
)
          –
          <div class="doc-md-description">
<p>Additional keyword arguments (passed through to <code>Preset</code>).</p>
</div>
</li>
</ul>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">192</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">193</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">194</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">195</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">196</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">197</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">198</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">199</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">200</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">201</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">202</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">203</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">204</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">205</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">206</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">207</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">208</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">209</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">210</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">211</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">212</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">213</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">214</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">215</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">216</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">217</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">218</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">219</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">220</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">221</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">222</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">223</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">224</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">225</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">226</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">227</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">228</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">229</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">230</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">231</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">232</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">233</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">234</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">235</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">236</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(</span>
    <span style="color: #e6edf3">self,</span>
    <span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">targets,</span>
    <span style="color: #e6edf3">scan_id</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span>
    <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs,</span>
<span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Initializes the Scanner class.</span>

<span style="color: #a5d6ff">    If a premade `preset` is specified, it will be used for the scan.</span>
<span style="color: #a5d6ff">    Otherwise, `Scan` accepts the same arguments as `Preset`, which are passed through and used to create a new preset.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        *targets (list[str], optional): Scan targets (passed through to `Preset`).</span>
<span style="color: #a5d6ff">        preset (Preset, optional): Preset to use for the scan.</span>
<span style="color: #a5d6ff">        scan_id (str, optional): Unique identifier for the scan. Auto-generates if None.</span>
<span style="color: #a5d6ff">        dispatcher (Dispatcher, optional): Dispatcher object to use. Defaults to new Dispatcher.</span>
<span style="color: #a5d6ff">        **kwargs (list[str], optional): Additional keyword arguments (passed through to `Preset`).</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">scan_id</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(id)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">id</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"SCAN:{</span><span style="color: #e6edf3">sha1(rand_string(</span><span style="color: #a5d6ff">20</span><span style="color: #e6edf3">))</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hexdigest()</span><span style="color: #a5d6ff">}"</span>

    <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">kwargs</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(</span><span style="color: #a5d6ff">"preset"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">kwargs[</span><span style="color: #a5d6ff">"_log"</span><span style="color: #e6edf3">]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>

    <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.preset</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">Preset</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Preset(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">targets,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">isinstance(preset,</span> <span style="color: #e6edf3">Preset):</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #e6edf3">ValidationError(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Preset must be of type Preset, not "{</span><span style="color: #e6edf3">type(preset)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #79c0ff">__name__</span><span style="color: #a5d6ff">}"'</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bake(self)</span>

    <span style="color: #8b949e; font-style: italic"># scan name</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">4</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}_{</span><span style="color: #e6edf3">rand_string(</span><span style="color: #a5d6ff">4</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}"</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">random_name()</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">home_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">scan_name</span>
            <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">home_path</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bbot_home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"scans"</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">scan_name</span>
            <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">home_path</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">exists():</span>
                <span style="color: #ff7b72">break</span>
            <span style="color: #e6edf3">tries</span> <span style="color: #ff7b72; font-weight: bold">+=</span> <span style="color: #a5d6ff">1</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">scan_name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">str(preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_name)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">scan_name</span>

    <span style="color: #8b949e; font-style: italic"># scan output dir</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Path(preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_dir)</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve()</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">home</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">bbot_home</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #a5d6ff">"scans"</span> <span style="color: #ff7b72; font-weight: bold">/</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"NOT_STARTED"</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_code</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">0</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">OrderedDict({})</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dummy_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.dispatcher</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">Dispatcher</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">Dispatcher()</span>
    <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dispatcher</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">set_scan(self)</span>

    <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.stats</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">ScanStats</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stats</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanStats(self)</span>

    <span style="color: #8b949e; font-style: italic"># scope distance</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"scope"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_search_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max(</span><span style="color: #a5d6ff">0</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">int(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"search_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)))</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_report_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">int(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scope_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"report_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">))</span>

    <span style="color: #8b949e; font-style: italic"># web config</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"web"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_distance</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_distance"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_depth</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_depth"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_links_per_page</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"spider_links_per_page"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">20</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">max_redirects</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_max_redirects"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_max_redirects</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">max(max_redirects,</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_spider_distance)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_proxy</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_proxy"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">""</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">10</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">httpx_timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"httpx_timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">http_retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">httpx_retries</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"httpx_retries"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">useragent</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"user_agent"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"BBOT"</span><span style="color: #e6edf3">)</span>
    <span style="color: #8b949e; font-style: italic"># custom HTTP headers warning</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_http_headers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">web_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"http_headers"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">custom_http_headers:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span>
            <span style="color: #a5d6ff">"You have enabled custom HTTP headers. These will be attached to all in-scope requests and all requests made by httpx."</span>
        <span style="color: #e6edf3">)</span>

    <span style="color: #8b949e; font-style: italic"># url file extensions</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_extension_blacklist</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_extension_blacklist"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[]))</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_extension_httpx_only</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">set(e</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lower()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_extension_httpx_only"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[]))</span>

    <span style="color: #8b949e; font-style: italic"># url querystring behavior</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">url_querystring_remove</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"url_querystring_remove"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>

    <span style="color: #8b949e; font-style: italic"># blob inclusion</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_file_blobs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"file_blobs"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_folder_blobs</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"folder_blobs"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

    <span style="color: #8b949e; font-style: italic"># how often to print scan status</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_frequency</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"status_frequency"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">15</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prepped</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_finished_init</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanedup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_omitted_event_types</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__loop</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_manager_worker_loop_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher_tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_strings</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_dns_regexes</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">__log_handlers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_log_handler_backup</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.async_start">
<span class="doc doc-object-name doc-function-name">async_start</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">async_start()</span>
</code></pre></div>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">304</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">305</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">306</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">307</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">308</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">309</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">310</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">311</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">312</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">313</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">314</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">315</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">316</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">317</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">318</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">319</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">320</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">321</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">322</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">323</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">324</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">325</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">326</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">327</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">328</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">329</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">330</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">331</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">332</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">333</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">334</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">335</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">336</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">337</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">338</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">339</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">340</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">341</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">342</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">343</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">344</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">345</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">346</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">347</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">348</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">349</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">350</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">351</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">352</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">353</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">354</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">355</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">356</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">357</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">358</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">359</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">360</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">361</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">362</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">363</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">364</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">365</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">366</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">367</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">368</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">369</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">370</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">371</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">372</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">373</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">374</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">375</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">376</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">377</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">378</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">379</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">380</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">381</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">382</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">383</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">384</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">385</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">386</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">387</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">388</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">389</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">390</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">391</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">392</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">393</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">394</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">395</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">396</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">397</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">398</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">399</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">400</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">401</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">402</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">403</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">404</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">405</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">406</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">407</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">408</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">409</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">410</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">411</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">412</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">async_start</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">""" """</span>
    <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
    <span style="color: #e6edf3">scan_start_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span>
    <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_prep()</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_start_log_handlers()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">'Ran BBOT {</span><span style="color: #e6edf3">__version__</span><span style="color: #a5d6ff">} at {</span><span style="color: #e6edf3">scan_start_time</span><span style="color: #a5d6ff">}, command: {" "</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(sys</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">argv)</span><span style="color: #a5d6ff">}'</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Target: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">json</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Preset: {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">to_dict(redact_secrets</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No scan targets specified"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># start status ticker</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ticker_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_status_ticker(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status_frequency),</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}._status_ticker()"</span>
        <span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"STARTING"</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No modules loaded"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FAILED"</span>
            <span style="color: #ff7b72">return</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Starting scan {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">on_start(self)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"RUNNING"</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_start_modules()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span><span style="color: #a5d6ff">:,} modules started"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># distribute seed events</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events_task</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">create_task(</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">init_events(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">target</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">events),</span> <span style="color: #e6edf3">name</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}.ingress_module.init_events()"</span>
        <span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># main scan loop</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #8b949e; font-style: italic"># abort if we're aborting</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aborting:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
                <span style="color: #ff7b72">break</span>

            <span style="color: #8b949e; font-style: italic"># yield events as they come (async for event in scan.async_start())</span>
            <span style="color: #ff7b72">if</span> <span style="color: #a5d6ff">"python"</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
                <span style="color: #e6edf3">events,</span> <span style="color: #e6edf3">finish</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[</span><span style="color: #a5d6ff">"python"</span><span style="color: #e6edf3">]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_events_waiting(batch_size</span><span style="color: #ff7b72; font-weight: bold">=-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">)</span>
                <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">e</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">events:</span>
                    <span style="color: #ff7b72">yield</span> <span style="color: #e6edf3">e</span>
                <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">events:</span>
                    <span style="color: #ff7b72">continue</span>

            <span style="color: #8b949e; font-style: italic"># break if initialization finished and the scan is no longer active</span>
            <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_finished_init</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules_finished:</span>
                <span style="color: #e6edf3">new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">finish()</span>
                <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">new_activity:</span>
                    <span style="color: #ff7b72">break</span>

            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">sleep(</span><span style="color: #a5d6ff">0.1</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>

    <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">BaseException</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">in_exception_chain(e,</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">KeyboardInterrupt</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">CancelledError)):</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">stop()</span>
            <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">raise</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">ScanError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">error(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"{</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">BBOTError</span> <span style="color: #ff7b72">as</span> <span style="color: #e6edf3">e:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Error during scan: {</span><span style="color: #e6edf3">e</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

            <span style="color: #ff7b72">except</span> <span style="color: #f0883e; font-weight: bold">Exception</span><span style="color: #e6edf3">:</span>
                <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Unexpected error during scan:</span><span style="color: #79c0ff">\n</span><span style="color: #a5d6ff">{</span><span style="color: #e6edf3">traceback</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">format_exc()</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">finally</span><span style="color: #e6edf3">:</span>
        <span style="color: #e6edf3">tasks</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cancel_tasks()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Awaiting {</span><span style="color: #e6edf3">len(tasks)</span><span style="color: #a5d6ff">:,} tasks"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">tasks:</span>
            <span style="color: #8b949e; font-style: italic"># self.debug(f"Awaiting {task}")</span>
            <span style="color: #ff7b72">with</span> <span style="color: #e6edf3">contextlib</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">suppress(</span><span style="color: #f0883e; font-weight: bold">BaseException</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">asyncio</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wait_for(task,</span> <span style="color: #e6edf3">timeout</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">0.1</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Awaited {</span><span style="color: #e6edf3">len(tasks)</span><span style="color: #a5d6ff">:,} tasks"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_report()</span>
        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cleanup()</span>

        <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugesuccess</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">"ABORTING"</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"ABORTED"</span>
            <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugewarning</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">failed:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FAILED"</span>
            <span style="color: #e6edf3">log_fn</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">critical</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FINISHED"</span>

        <span style="color: #e6edf3">scan_run_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">datetime</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">now()</span> <span style="color: #ff7b72; font-weight: bold">-</span> <span style="color: #e6edf3">scan_start_time</span>
        <span style="color: #e6edf3">scan_run_time</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">human_timedelta(scan_run_time)</span>
        <span style="color: #e6edf3">log_fn(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Scan {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">} completed in {</span><span style="color: #e6edf3">scan_run_time</span><span style="color: #a5d6ff">} with status {</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>

        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dispatcher</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">on_finish(self)</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stop_log_handlers()</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.finish">
<span class="doc doc-object-name doc-function-name">finish</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">finish()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Finalizes the scan by invoking the <code>finished()</code> method on all active modules if new activity is detected.</p>
<p>The method is idempotent and will return False if no new activity has been recorded since the last invocation.</p>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>bool</code></b>          –
          <div class="doc-md-description">
<p>True if new activity has been detected and the <code>finished()</code> method is invoked on all modules.
  False if no new activity has been detected since the last invocation.</p>
</div>
</li>
</ul>
<details class="notes" open="">
<summary>Notes</summary>
<p>This method alters the scan's status to "FINISHING" if new activity is detected.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">704</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">705</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">706</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">707</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">708</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">709</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">710</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">711</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">712</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">713</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">714</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">715</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">716</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">717</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">718</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">719</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">720</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">721</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">722</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">723</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">724</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">725</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">726</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">727</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">728</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">729</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">finish</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Finalizes the scan by invoking the `finished()` method on all active modules if new activity is detected.</span>

<span style="color: #a5d6ff">    The method is idempotent and will return False if no new activity has been recorded since the last invocation.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        bool: True if new activity has been detected and the `finished()` method is invoked on all modules.</span>
<span style="color: #a5d6ff">              False if no new activity has been detected since the last invocation.</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        This method alters the scan's status to "FINISHING" if new activity is detected.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #8b949e; font-style: italic"># if new events were generated since last time we were here</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_new_activity</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">False</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"FINISHING"</span>
        <span style="color: #8b949e; font-style: italic"># Trigger .finished() on every module and start over</span>
        <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #a5d6ff">"Finishing scan"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">module</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values():</span>
            <span style="color: #e6edf3">finished_event</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">make_event(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"FINISHED"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">"FINISHED"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">dummy</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">tags</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name})</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">queue_event(finished_event)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Completed finish()"</span><span style="color: #e6edf3">)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">True</span>
    <span style="color: #8b949e; font-style: italic"># Return False if no new events were generated since last time</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #a5d6ff">"Completed final finish()"</span><span style="color: #e6edf3">)</span>
    <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.load_modules">
<span class="doc doc-object-name doc-function-name">load_modules</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">load_modules()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronously import and instantiate all scan modules, including internal and output modules.</p>
<p>This method is automatically invoked by <code>setup_modules()</code>. It performs several key tasks in the following sequence:</p>
<ol>
<li>Install dependencies for each module via <code>self.helpers.depsinstaller.install()</code>.</li>
<li>Load scan modules and updates the <code>modules</code> dictionary.</li>
<li>Load internal modules and updates the <code>modules</code> dictionary.</li>
<li>Load output modules and updates the <code>modules</code> dictionary.</li>
<li>Sorts modules based on their <code>_priority</code> attribute.</li>
</ol>
<p>If any modules fail to load or their dependencies fail to install, a ScanError will be raised (unless <code>self.force_start</code> is True).</p>
<p><span class="doc-section-title">Attributes:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.load_modules.succeeded,">succeeded,</span></code></b>
              (<code>failed (tuple</code>)
          –
          <div class="doc-md-description">
<p>A tuple containing lists of modules that succeeded or failed during the dependency installation.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.load_modules.loaded_modules,">loaded_modules,</span></code></b>
              (<code>loaded_internal_modules, loaded_output_modules (dict</code>)
          –
          <div class="doc-md-description">
<p>Dictionaries of successfully loaded modules.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code><span title="bbot.scanner.Scanner.load_modules.failed,">failed,</span></code></b>
              (<code>failed_internal, failed_output (list</code>)
          –
          <div class="doc-md-description">
<p>Lists of module names that failed to load.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><span title="bbot.errors.ScanError">ScanError</span></code>
            –
          <div class="doc-md-description">
<p>If any module dependencies fail to install or modules fail to load, and if <code>self.force_start</code> is False.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
<p>None</p>
</div>
</li>
</ul>
<details class="note" open="">
<summary>Note</summary>
<p>After all modules are loaded, they are sorted by <code>_priority</code> and stored in the <code>modules</code> dictionary.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">462</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">463</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">464</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">465</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">466</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">467</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">468</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">469</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">470</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">471</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">472</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">473</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">474</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">475</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">476</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">477</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">478</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">479</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">480</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">481</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">482</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">483</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">484</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">485</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">486</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">487</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">488</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">489</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">490</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">491</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">492</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">493</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">494</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">495</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">496</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">497</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">498</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">499</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">500</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">501</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">502</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">503</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">504</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">505</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">506</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">507</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">508</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">509</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">510</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">511</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">512</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">513</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">514</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">515</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">516</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">517</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">518</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">519</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">520</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">521</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">522</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">523</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">524</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">525</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">526</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">527</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">528</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">529</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">530</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">531</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">532</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">533</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">534</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">535</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">536</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">537</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">538</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">539</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">540</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">541</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">542</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">543</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">544</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">545</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">546</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">547</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">548</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">549</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">550</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">551</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">load_modules</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Asynchronously import and instantiate all scan modules, including internal and output modules.</span>

<span style="color: #a5d6ff">    This method is automatically invoked by `setup_modules()`. It performs several key tasks in the following sequence:</span>

<span style="color: #a5d6ff">    1. Install dependencies for each module via `self.helpers.depsinstaller.install()`.</span>
<span style="color: #a5d6ff">    2. Load scan modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">    3. Load internal modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">    4. Load output modules and updates the `modules` dictionary.</span>
<span style="color: #a5d6ff">    5. Sorts modules based on their `_priority` attribute.</span>

<span style="color: #a5d6ff">    If any modules fail to load or their dependencies fail to install, a ScanError will be raised (unless `self.force_start` is True).</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        succeeded, failed (tuple): A tuple containing lists of modules that succeeded or failed during the dependency installation.</span>
<span style="color: #a5d6ff">        loaded_modules, loaded_internal_modules, loaded_output_modules (dict): Dictionaries of successfully loaded modules.</span>
<span style="color: #a5d6ff">        failed, failed_internal, failed_output (list): Lists of module names that failed to load.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ScanError: If any module dependencies fail to install or modules fail to load, and if `self.force_start` is False.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        None</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        After all modules are loaded, they are sorted by `_priority` and stored in the `modules` dictionary.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded:</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No modules to load"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span>

        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"No scan modules to load"</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># install module dependencies</span>
        <span style="color: #e6edf3">succeeded,</span> <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">depsinstaller</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">install(</span><span style="color: #ff7b72; font-weight: bold">*</span><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">failed:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to install dependencies for {</span><span style="color: #e6edf3">len(failed)</span><span style="color: #a5d6ff">:,} modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed)</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
        <span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>
        <span style="color: #e6edf3">output_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>
        <span style="color: #e6edf3">internal_modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">sorted([m</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">internal_modules</span> <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">succeeded])</span>

        <span style="color: #8b949e; font-style: italic"># Load scan modules</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(modules)</span><span style="color: #a5d6ff">:,} scan modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">loaded_modules,</span> <span style="color: #e6edf3">failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(modules)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_modules)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(failed)</span><span style="color: #a5d6ff">:,} scan modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed)</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">scan_modules)</span><span style="color: #a5d6ff">:,} scan modules ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_modules)</span><span style="color: #a5d6ff">})"</span>
            <span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># Load internal modules</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(internal_modules)</span><span style="color: #a5d6ff">:,} internal modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(internal_modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">loaded_internal_modules,</span> <span style="color: #e6edf3">failed_internal</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(internal_modules)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_internal_modules)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed_internal)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(loaded_internal_modules)</span><span style="color: #a5d6ff">:,} internal modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_internal_modules)</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_internal_modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_internal_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">internal_modules)</span><span style="color: #a5d6ff">:,} internal modules ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_internal_modules)</span><span style="color: #a5d6ff">})"</span>
            <span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># Load output modules</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loading {</span><span style="color: #e6edf3">len(output_modules)</span><span style="color: #a5d6ff">:,} output modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(output_modules)</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">loaded_output_modules,</span> <span style="color: #e6edf3">failed_output</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_load_modules(output_modules)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">update(loaded_output_modules)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">len(failed_output)</span> <span style="color: #ff7b72; font-weight: bold">&gt;</span> <span style="color: #a5d6ff">0</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Failed to load {</span><span style="color: #e6edf3">len(failed_output)</span><span style="color: #a5d6ff">:,} output modules: {','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(failed_output)</span><span style="color: #a5d6ff">}"</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_fail_setup(msg)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">loaded_output_modules:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span>
                <span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Loaded {</span><span style="color: #e6edf3">len(loaded_output_modules)</span><span style="color: #a5d6ff">:,}/{</span><span style="color: #e6edf3">len(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">preset</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">output_modules)</span><span style="color: #a5d6ff">:,} output modules, ({','</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">join(loaded_output_modules)</span><span style="color: #a5d6ff">})"</span>
            <span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># builtin intercept modules</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanIngress(self)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">ScanEgress(self)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">ingress_module</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">egress_module</span>

        <span style="color: #8b949e; font-style: italic"># sort modules by priority</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">OrderedDict(sorted(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">items(),</span> <span style="color: #e6edf3">key</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #ff7b72">lambda</span> <span style="color: #e6edf3">x:</span> <span style="color: #e6edf3">getattr(x[</span><span style="color: #ff7b72; font-weight: bold">-</span><span style="color: #a5d6ff">1</span><span style="color: #e6edf3">],</span> <span style="color: #a5d6ff">"priority"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">3</span><span style="color: #e6edf3">)))</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_modules_loaded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.setup_modules">
<span class="doc doc-object-name doc-function-name">setup_modules</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">setup_modules(remove_failed</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Asynchronously initializes all loaded modules by invoking their <code>setup()</code> methods.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>remove_failed</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/functions.html#bool">bool</a></code>, default:
                  <code>True</code>
)
          –
          <div class="doc-md-description">
<p>Flag indicating whether to remove modules that fail setup.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>tuple</code></b>          –
          <div class="doc-md-description">
<p>succeeded - List of modules that successfully set up.
hard_failed - List of modules that encountered a hard failure during setup.
soft_failed - List of modules that encountered a soft failure during setup.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><span title="bbot.errors.ScanError">ScanError</span></code>
            –
          <div class="doc-md-description">
<p>If no output modules could be loaded.</p>
</div>
</li>
</ul>
<details class="notes" open="">
<summary>Notes</summary>
<p>Hard-failed modules are set to an error state and removed if <code>remove_failed</code> is True.
Soft-failed modules are not set to an error state but are also removed if <code>remove_failed</code> is True.</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">419</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">420</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">421</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">422</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">423</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">424</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">425</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">426</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">427</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">428</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">429</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">430</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">431</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">432</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">433</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">434</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">435</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">436</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">437</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">438</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">439</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">440</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">441</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">442</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">443</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">444</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">445</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">446</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">447</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">448</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">449</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">450</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">451</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">452</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">453</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">454</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">455</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">456</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">457</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">458</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">459</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">460</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">setup_modules</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">remove_failed</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">True</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Asynchronously initializes all loaded modules by invoking their `setup()` methods.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        remove_failed (bool): Flag indicating whether to remove modules that fail setup.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        tuple:</span>
<span style="color: #a5d6ff">            succeeded - List of modules that successfully set up.</span>
<span style="color: #a5d6ff">            hard_failed - List of modules that encountered a hard failure during setup.</span>
<span style="color: #a5d6ff">            soft_failed - List of modules that encountered a soft failure during setup.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ScanError: If no output modules could be loaded.</span>

<span style="color: #a5d6ff">    Notes:</span>
<span style="color: #a5d6ff">        Hard-failed modules are set to an error state and removed if `remove_failed` is True.</span>
<span style="color: #a5d6ff">        Soft-failed modules are not set to an error state but are also removed if `remove_failed` is True.</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">load_modules()</span>
    <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">verbose(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setting up modules"</span><span style="color: #e6edf3">)</span>
    <span style="color: #e6edf3">succeeded</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">hard_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>
    <span style="color: #e6edf3">soft_failed</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">[]</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">task</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">as_completed([m</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_setup()</span> <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">m</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">values()]):</span>
        <span style="color: #e6edf3">module,</span> <span style="color: #e6edf3">status,</span> <span style="color: #e6edf3">msg</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">task</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">True</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup succeeded for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">} ({</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">})"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">succeeded</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
        <span style="color: #ff7b72">elif</span> <span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">warning(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup hard-failed for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules[module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">set_error_state()</span>
            <span style="color: #e6edf3">hard_failed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
        <span style="color: #ff7b72">else</span><span style="color: #e6edf3">:</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">info(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Setup soft-failed for {</span><span style="color: #e6edf3">module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name</span><span style="color: #a5d6ff">}: {</span><span style="color: #e6edf3">msg</span><span style="color: #a5d6ff">}"</span><span style="color: #e6edf3">)</span>
            <span style="color: #e6edf3">soft_failed</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">append(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">(</span><span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">status)</span> <span style="color: #ff7b72; font-weight: bold">and</span> <span style="color: #e6edf3">(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_intercept</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #e6edf3">remove_failed):</span>
            <span style="color: #8b949e; font-style: italic"># if a intercept module fails setup, we always remove it</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">modules</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">pop(module</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">name)</span>

    <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">succeeded,</span> <span style="color: #e6edf3">hard_failed,</span> <span style="color: #e6edf3">soft_failed</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.scanner.Scanner.stop">
<span class="doc doc-object-name doc-function-name">stop</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">stop()</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Stops the in-progress scan and performs necessary cleanup.</p>
<p>This method sets the scan's status to "ABORTING," cancels any pending tasks, and drains event queues. It also kills child processes spawned during the scan.</p>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
<p>None</p>
</div>
</li>
</ul>
<details class="quote">
<summary>Source code in <code>bbot/scanner/scanner.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">684</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">685</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">686</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">687</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">688</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">689</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">690</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">691</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">692</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">693</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">694</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">695</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">696</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">697</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">698</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">699</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">700</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">701</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">702</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">stop</span><span style="color: #e6edf3">(self):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Stops the in-progress scan and performs necessary cleanup.</span>

<span style="color: #a5d6ff">    This method sets the scan's status to "ABORTING," cancels any pending tasks, and drains event queues. It also kills child processes spawned during the scan.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        None</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping:</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_stopping</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">status</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #a5d6ff">"ABORTING"</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">hugewarning(</span><span style="color: #a5d6ff">"Aborting scan"</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">trace()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_cancel_tasks()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">kill_children()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_drain_queues()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">kill_children()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #a5d6ff">"Finished aborting scan"</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.tooltips", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "Stable", "provider": "mike"}}</script>
<script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
<script src="../../javascripts/tablesort.js"></script>
<script src="../../javascripts/vega@5.js"></script>
<script src="../../javascripts/vega-lite@5.js"></script>
<script src="../../javascripts/vega-embed@6.js"></script>
<script src="../../data/chord_graph/vega.json"></script>
</body>
</html>