
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="OSINT automation for hackers" name="description"/>
<meta content="TheTechromancer" name="author"/>
<link href="https://blacklanternsecurity.github.io/bbot/dev/helpers/dns/" rel="canonical"/>
<link href="../command/" rel="prev"/>
<link href="../interactsh/" rel="next"/>
<link href="../../../favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.0, mkdocs-material-9.5.26" name="generator"/>
<title>DNS - BBOT Docs</title>
<link href="../../../assets/stylesheets/main.6543a935.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../../assets/stylesheets/extra-style.9lnr19u7.min.css" rel="stylesheet"/></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#dns">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="BBOT Docs" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BBOT Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              DNS
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-hidden="true" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
</form>
<script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
          
  
  User Manual

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../">
          
  
  Developer Manual

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BBOT Docs" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="BBOT Docs">
<img alt="logo" src="../../../bbot.png"/>
</a>
    BBOT Docs
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/blacklanternsecurity/bbot" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    blacklanternsecurity/bbot
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    User Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            User Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
<span class="md-ellipsis">
    Basics
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
            Basics
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Getting Started
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../how_it_works/">
<span class="md-ellipsis">
    How it Works
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../comparison/">
<span class="md-ellipsis">
    Comparison to Other Tools
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
<span class="md-ellipsis">
    Scanning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
            Scanning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/">
<span class="md-ellipsis">
    Scanning Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_2" id="__nav_1_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Presets
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_2">
<span class="md-nav__icon md-icon"></span>
            Presets
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/presets/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/presets_list/">
<span class="md-ellipsis">
    List of Presets
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/events/">
<span class="md-ellipsis">
    Events
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/output/">
<span class="md-ellipsis">
    Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/tips_and_tricks/">
<span class="md-ellipsis">
    Tips and Tricks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/advanced/">
<span class="md-ellipsis">
    Advanced Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../scanning/configuration/">
<span class="md-ellipsis">
    Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
<span class="md-ellipsis">
    Modules
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            Modules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/list_of_modules/">
<span class="md-ellipsis">
    List of Modules
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../modules/nuclei/">
<span class="md-ellipsis">
    Nuclei
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Misc
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            Misc
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribution/">
<span class="md-ellipsis">
    Contribution
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../release_history/">
<span class="md-ellipsis">
    Release History
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../troubleshooting/">
<span class="md-ellipsis">
    Troubleshooting
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Developer Manual
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Developer Manual
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Development Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../architecture/">
<span class="md-ellipsis">
    BBOT Internal Architecture
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../module_howto/">
<span class="md-ellipsis">
    How to Write a BBOT Module
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tests/">
<span class="md-ellipsis">
    Unit Tests
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../discord_bot/">
<span class="md-ellipsis">
    Discord Bot Example
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="">
<span class="md-ellipsis">
    Code Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../scanner/">
<span class="md-ellipsis">
    Scanner
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../presets/">
<span class="md-ellipsis">
    Presets
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../event/">
<span class="md-ellipsis">
    Event
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../target/">
<span class="md-ellipsis">
    Target
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../basemodule/">
<span class="md-ellipsis">
    BaseModule
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../core/">
<span class="md-ellipsis">
    BBOTCore
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../engine/">
<span class="md-ellipsis">
    Engine
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2_6_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6_8" id="__nav_2_6_8_label" tabindex="0">
<span class="md-ellipsis">
    Helpers
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_6_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_6_8">
<span class="md-nav__icon md-icon"></span>
            Helpers
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../command/">
<span class="md-ellipsis">
    Command
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactsh/">
<span class="md-ellipsis">
    Interactsh
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../misc/">
<span class="md-ellipsis">
    Miscellaneous
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../web/">
<span class="md-ellipsis">
    Web
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wordcloud/">
<span class="md-ellipsis">
    Word Cloud
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="dns">DNS</h1>
<p>These are helpers related to DNS resolution. They are used throughout BBOT and its modules for performing DNS lookups and detecting DNS wildcards, etc.</p>
<p>Note that these helpers can be invoked directly from <code>self.helpers</code>, e.g.:</p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">helpers</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolve(</span><span style="color: #a5d6ff">"evilcorp.com"</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-object doc-class">
<h1 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper">
<span class="doc doc-object-name doc-class-name">DNSHelper</span>
</h1>
<div class="doc doc-contents first">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="bbot.core.engine.EngineClient" href="../../engine/#bbot.core.engine.EngineClient">EngineClient</a></code></p>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 16</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 17</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 18</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 19</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 20</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 21</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 22</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 23</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 24</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 25</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 26</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 27</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 28</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 29</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 30</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 31</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 32</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 33</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 34</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 35</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 36</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 37</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 38</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 39</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 40</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 41</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 42</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 43</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 44</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 45</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 46</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 47</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 48</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 49</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 50</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 51</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 52</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 53</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 54</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 55</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 56</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 57</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 58</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 59</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 60</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 61</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 62</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 63</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 64</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 65</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 66</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 67</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 68</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 69</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 70</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 71</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 72</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 73</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 74</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 75</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 76</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 77</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 78</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 79</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 80</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 81</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 83</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 84</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 86</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 87</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 95</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 96</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 97</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 98</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;"> 99</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">100</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">101</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">102</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">103</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">104</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">105</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">106</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">107</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">108</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">109</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">110</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">111</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">112</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">113</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">158</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">165</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">166</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">167</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">168</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">169</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">170</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">171</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">172</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">173</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">174</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">175</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">176</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">177</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">178</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">179</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">180</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">181</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">182</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">183</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">184</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">185</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">186</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">187</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">188</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">189</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">190</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">191</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">class</span> <span style="color: #f0883e; font-weight: bold">DNSHelper</span><span style="color: #e6edf3">(EngineClient):</span>

    <span style="color: #e6edf3">SERVER_CLASS</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">DNSEngine</span>
    <span style="color: #e6edf3">ERROR_CLASS</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">DNSError</span>

<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""Helper class for DNS-related operations within BBOT.</span>

<span style="color: #a5d6ff">    This class provides mechanisms for host resolution, wildcard domain detection, event tagging, and more.</span>
<span style="color: #a5d6ff">    It centralizes all DNS-related activities in BBOT, offering both synchronous and asynchronous methods</span>
<span style="color: #a5d6ff">    for DNS resolution, as well as various utilities for batch resolution and DNS query filtering.</span>

<span style="color: #a5d6ff">    Attributes:</span>
<span style="color: #a5d6ff">        parent_helper: A reference to the instantiated `ConfigAwareHelper` (typically `scan.helpers`).</span>
<span style="color: #a5d6ff">        resolver (BBOTAsyncResolver): An asynchronous DNS resolver tailored for BBOT with rate-limiting capabilities.</span>
<span style="color: #a5d6ff">        timeout (int): The timeout value for DNS queries. Defaults to 5 seconds.</span>
<span style="color: #a5d6ff">        retries (int): The number of retries for failed DNS queries. Defaults to 1.</span>
<span style="color: #a5d6ff">        abort_threshold (int): The threshold for aborting after consecutive failed queries. Defaults to 50.</span>
<span style="color: #a5d6ff">        runaway_limit (int): Maximum allowed distance for consecutive DNS resolutions. Defaults to 5.</span>
<span style="color: #a5d6ff">        all_rdtypes (list): A list of DNS record types to be considered during operations.</span>
<span style="color: #a5d6ff">        wildcard_ignore (tuple): Domains to be ignored during wildcard detection.</span>
<span style="color: #a5d6ff">        wildcard_tests (int): Number of tests to be run for wildcard detection. Defaults to 5.</span>
<span style="color: #a5d6ff">        _wildcard_cache (dict): Cache for wildcard detection results.</span>
<span style="color: #a5d6ff">        _dns_cache (LRUCache): Cache for DNS resolution results, limited in size.</span>
<span style="color: #a5d6ff">        resolver_file (Path): File containing system's current resolver nameservers.</span>
<span style="color: #a5d6ff">        filter_bad_ptrs (bool): Whether to filter out DNS names that appear to be auto-generated PTR records. Defaults to True.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        parent_helper: The parent helper object with configuration details and utilities.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        DNSError: If an issue arises when creating the BBOTAsyncResolver instance.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; dns_helper = DNSHelper(parent_config)</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; resolved_host = dns_helper.resolver.resolve("example.com")</span>
<span style="color: #a5d6ff">    """</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">parent_helper):</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">parent_helper</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_config</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"dns"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">{})</span>
        <span style="color: #e6edf3">super()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__init__</span><span style="color: #e6edf3">(server_kwargs</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">{</span><span style="color: #a5d6ff">"config"</span><span style="color: #e6edf3">:</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config})</span>

        <span style="color: #8b949e; font-style: italic"># resolver</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"timeout"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">asyncresolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Resolver()</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">rotate</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">True</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">lifetime</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">timeout</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">runaway_limit</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"runaway_limit"</span><span style="color: #e6edf3">,</span> <span style="color: #a5d6ff">5</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># wildcard handling</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_disable</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"wildcard_disable"</span><span style="color: #e6edf3">,</span> <span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">RadixTarget()</span>
        <span style="color: #ff7b72">for</span> <span style="color: #e6edf3">d</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">dns_config</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">get(</span><span style="color: #a5d6ff">"wildcard_ignore"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">[]):</span>
            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">insert(d)</span>

        <span style="color: #8b949e; font-style: italic"># copy the system's current resolvers to a text file for tool use</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">system_resolvers</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">dns</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">Resolver()</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">nameservers</span>
        <span style="color: #8b949e; font-style: italic"># TODO: DNS server speed test (start in background task)</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver_file</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">tempfile(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">system_resolvers,</span> <span style="color: #e6edf3">pipe</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

        <span style="color: #8b949e; font-style: italic"># brute force helper</span>
        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_brute</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #79c0ff">None</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"resolve"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_raw</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"resolve_raw"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
        <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"resolve_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">queries</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
                <span style="color: #ff7b72">break</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_raw_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">queries):</span>
        <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"resolve_raw_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">queries</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">queries)</span>
        <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
                <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
            <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
                <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
                <span style="color: #ff7b72">break</span>

    <span style="color: #d2a8ff; font-weight: bold">@property</span>
    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">brute</span><span style="color: #e6edf3">(self):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_brute</span> <span style="color: #ff7b72; font-weight: bold">is</span> <span style="color: #79c0ff">None</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.brute</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">DNSBrute</span>

            <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_brute</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">DNSBrute(self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">parent_helper)</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_brute</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">        </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">        Use this method to check whether a *host* is a wildcard entry</span>

<span style="color: #a5d6ff">        This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</span>

<span style="color: #a5d6ff">        If you want to know whether a domain is using wildcard DNS, use `is_wildcard_domain()` instead.</span>

<span style="color: #a5d6ff">        Args:</span>
<span style="color: #a5d6ff">            query (str): The hostname to check for a wildcard entry.</span>
<span style="color: #a5d6ff">            ips (list, optional): List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</span>
<span style="color: #a5d6ff">            rdtype (str, optional): The DNS record type (e.g., "A", "AAAA") to consider during the check.</span>

<span style="color: #a5d6ff">        Returns:</span>
<span style="color: #a5d6ff">            dict: A dictionary indicating if the query is a wildcard for each checked DNS record type.</span>
<span style="color: #a5d6ff">                Keys are DNS record types like "A", "AAAA", etc.</span>
<span style="color: #a5d6ff">                Values are tuples where the first element is a boolean indicating if the query is a wildcard,</span>
<span style="color: #a5d6ff">                and the second element is the wildcard parent if it's a wildcard.</span>

<span style="color: #a5d6ff">        Raises:</span>
<span style="color: #a5d6ff">            ValueError: If only one of `ips` or `rdtype` is specified or if no valid IPs are specified.</span>

<span style="color: #a5d6ff">        Examples:</span>
<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard("www.github.io")</span>
<span style="color: #a5d6ff">            {"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>

<span style="color: #a5d6ff">            &gt;&gt;&gt; is_wildcard("www.evilcorp.com", ips=["93.184.216.34"], rdtype="A")</span>
<span style="color: #a5d6ff">            {"A": (False, "evilcorp.com")}</span>

<span style="color: #a5d6ff">        Note:</span>
<span style="color: #a5d6ff">            `is_wildcard` can be True, False, or None (indicating that wildcard detection was inconclusive)</span>
<span style="color: #a5d6ff">        """</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">[ips,</span> <span style="color: #e6edf3">rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">count(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Both ips and rdtype must be specified"</span><span style="color: #e6edf3">)</span>

        <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_prevalidation(query)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">query:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #8b949e; font-style: italic"># skip check if the query is a domain</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_domain(query):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"is_wildcard"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">ips,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">rdtype)</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard_domain</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
        <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_prevalidation(domain)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">domain:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

        <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"is_wildcard_domain"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">domain</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>

    <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_wildcard_prevalidation</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">host):</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_disable:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

        <span style="color: #e6edf3">host</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">clean_dns_record(host)</span>
        <span style="color: #8b949e; font-style: italic"># skip check if it's an IP or a plain hostname</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_ip(host)</span> <span style="color: #ff7b72; font-weight: bold">or</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #a5d6ff">"."</span> <span style="color: #ff7b72; font-weight: bold">in</span> <span style="color: #e6edf3">host:</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

        <span style="color: #8b949e; font-style: italic"># skip if query isn't a dns name</span>
        <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">is_dns_name(host):</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

        <span style="color: #8b949e; font-style: italic"># skip check if the query's parent domain is excluded in the config</span>
        <span style="color: #e6edf3">wildcard_ignore</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">wildcard_ignore</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">search(host)</span>
        <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">wildcard_ignore:</span>
            <span style="color: #e6edf3">log</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">debug(</span><span style="color: #79c0ff">f</span><span style="color: #a5d6ff">"Skipping wildcard detection on {</span><span style="color: #e6edf3">host</span><span style="color: #a5d6ff">} because {</span><span style="color: #e6edf3">wildcard_ignore</span><span style="color: #a5d6ff">} is excluded in the config"</span><span style="color: #e6edf3">)</span>
            <span style="color: #ff7b72">return</span> <span style="color: #79c0ff">False</span>

        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">host</span>

    <span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">_mock_dns</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">mock_data):</span>
        <span style="color: #ff7b72">from</span> <span style="color: #ff7b72">.mock</span> <span style="color: #ff7b72">import</span> <span style="color: #e6edf3">MockResolver</span>

        <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">resolver</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">MockResolver(mock_data)</span>
        <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"_mock_dns"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">mock_data</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">mock_data)</span>
</code></pre></div></td></tr></table></div>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve">
<span class="doc doc-object-name doc-function-name">resolve</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">82</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">83</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
    <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"resolve"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve_batch">
<span class="doc doc-object-name doc-function-name">resolve_batch</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve_batch(queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">88</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">89</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">90</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">91</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">92</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">93</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">94</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">95</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_batch</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
    <span style="color: #e6edf3">agen</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_yield(</span><span style="color: #a5d6ff">"resolve_batch"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">queries</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">queries,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
    <span style="color: #ff7b72">while</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">try</span><span style="color: #e6edf3">:</span>
            <span style="color: #ff7b72">yield</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #d2a8ff; font-weight: bold">__anext__</span><span style="color: #e6edf3">()</span>
        <span style="color: #ff7b72">except</span> <span style="color: #e6edf3">(</span><span style="color: #f0883e; font-weight: bold">StopAsyncIteration</span><span style="color: #e6edf3">,</span> <span style="color: #f0883e; font-weight: bold">GeneratorExit</span><span style="color: #e6edf3">):</span>
            <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">agen</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">aclose()</span>
            <span style="color: #ff7b72">break</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.resolve_raw">
<span class="doc doc-object-name doc-function-name">resolve_raw</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">resolve_raw(query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">85</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">86</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">resolve_raw</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs):</span>
    <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"resolve_raw"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #ff7b72; font-weight: bold">**</span><span style="color: #e6edf3">kwargs)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.is_wildcard">
<span class="doc doc-object-name doc-function-name">is_wildcard</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_wildcard(query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<p>Use this method to check whether a <em>host</em> is a wildcard entry</p>
<p>This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</p>
<p>If you want to know whether a domain is using wildcard DNS, use <code>is_wildcard_domain()</code> instead.</p>
<p><span class="doc-section-title">Parameters:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>query</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>)
          
          <div class="doc-md-description">
<p>The hostname to check for a wildcard entry.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>ips</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#list">list</a></code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
<p>List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</p>
</div>
</li>
<li class="doc-section-item field-body">
<b><code>rdtype</code></b>
              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/stdtypes.html#str">str</a></code>, default:
                  <code>None</code>
)
          
          <div class="doc-md-description">
<p>The DNS record type (e.g., "A", "AAAA") to consider during the check.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Returns:</span></p>
<ul>
<li class="doc-section-item field-body">
<b><code>dict</code></b>          
          <div class="doc-md-description">
<p>A dictionary indicating if the query is a wildcard for each checked DNS record type.
Keys are DNS record types like "A", "AAAA", etc.
Values are tuples where the first element is a boolean indicating if the query is a wildcard,
and the second element is the wildcard parent if it's a wildcard.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Raises:</span></p>
<ul>
<li class="doc-section-item field-body">
<code><a class="autorefs autorefs-external" href="https://docs.python.org/3.11/library/exceptions.html#ValueError">ValueError</a></code>
            
          <div class="doc-md-description">
<p>If only one of <code>ips</code> or <code>rdtype</code> is specified or if no valid IPs are specified.</p>
</div>
</li>
</ul>
<p><span class="doc-section-title">Examples:</span></p>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard(</span><span style="color: #a5d6ff">"www.github.io"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>
</code></pre></div>
<div class="highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #8b949e">&gt;&gt;&gt; </span><span style="color: #e6edf3">is_wildcard(</span><span style="color: #a5d6ff">"www.evilcorp.com"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">[</span><span style="color: #a5d6ff">"93.184.216.34"</span><span style="color: #e6edf3">],</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #a5d6ff">"A"</span><span style="color: #e6edf3">)</span>
<span style="color: #8b949e">{"A": (False, "evilcorp.com")}</span>
</code></pre></div>
<details class="note" open="">
<summary>Note</summary>
<p><code>is_wildcard</code> can be True, False, or None (indicating that wildcard detection was inconclusive)</p>
</details>
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">114</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">115</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">116</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">117</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">118</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">119</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">120</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">121</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">122</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">123</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">124</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">125</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">126</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">127</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">128</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">129</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">130</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">131</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">132</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">133</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">134</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">135</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">136</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">137</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">138</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">139</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">140</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">141</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">142</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">143</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">144</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">145</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">146</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">147</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">148</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">149</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">150</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">151</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">152</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">153</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">154</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">155</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">156</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">157</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">):</span>
<span style="color: #6e7681">    </span><span style="color: #a5d6ff">"""</span>
<span style="color: #a5d6ff">    Use this method to check whether a *host* is a wildcard entry</span>

<span style="color: #a5d6ff">    This can reliably tell the difference between a valid DNS record and a wildcard within a wildcard domain.</span>

<span style="color: #a5d6ff">    If you want to know whether a domain is using wildcard DNS, use `is_wildcard_domain()` instead.</span>

<span style="color: #a5d6ff">    Args:</span>
<span style="color: #a5d6ff">        query (str): The hostname to check for a wildcard entry.</span>
<span style="color: #a5d6ff">        ips (list, optional): List of IPs to compare against, typically obtained from a previous DNS resolution of the query.</span>
<span style="color: #a5d6ff">        rdtype (str, optional): The DNS record type (e.g., "A", "AAAA") to consider during the check.</span>

<span style="color: #a5d6ff">    Returns:</span>
<span style="color: #a5d6ff">        dict: A dictionary indicating if the query is a wildcard for each checked DNS record type.</span>
<span style="color: #a5d6ff">            Keys are DNS record types like "A", "AAAA", etc.</span>
<span style="color: #a5d6ff">            Values are tuples where the first element is a boolean indicating if the query is a wildcard,</span>
<span style="color: #a5d6ff">            and the second element is the wildcard parent if it's a wildcard.</span>

<span style="color: #a5d6ff">    Raises:</span>
<span style="color: #a5d6ff">        ValueError: If only one of `ips` or `rdtype` is specified or if no valid IPs are specified.</span>

<span style="color: #a5d6ff">    Examples:</span>
<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard("www.github.io")</span>
<span style="color: #a5d6ff">        {"A": (True, "github.io"), "AAAA": (True, "github.io")}</span>

<span style="color: #a5d6ff">        &gt;&gt;&gt; is_wildcard("www.evilcorp.com", ips=["93.184.216.34"], rdtype="A")</span>
<span style="color: #a5d6ff">        {"A": (False, "evilcorp.com")}</span>

<span style="color: #a5d6ff">    Note:</span>
<span style="color: #a5d6ff">        `is_wildcard` can be True, False, or None (indicating that wildcard detection was inconclusive)</span>
<span style="color: #a5d6ff">    """</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">[ips,</span> <span style="color: #e6edf3">rdtype]</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">count(</span><span style="color: #79c0ff">None</span><span style="color: #e6edf3">)</span> <span style="color: #ff7b72; font-weight: bold">==</span> <span style="color: #a5d6ff">1</span><span style="color: #e6edf3">:</span>
        <span style="color: #ff7b72">raise</span> <span style="color: #f0883e; font-weight: bold">ValueError</span><span style="color: #e6edf3">(</span><span style="color: #a5d6ff">"Both ips and rdtype must be specified"</span><span style="color: #e6edf3">)</span>

    <span style="color: #e6edf3">query</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_prevalidation(query)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">query:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #8b949e; font-style: italic"># skip check if the query is a domain</span>
    <span style="color: #ff7b72">if</span> <span style="color: #e6edf3">is_domain(query):</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"is_wildcard"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">query</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">query,</span> <span style="color: #e6edf3">ips</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">ips,</span> <span style="color: #e6edf3">rdtype</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">rdtype)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h2 class="doc doc-heading" id="bbot.core.helpers.dns.DNSHelper.is_wildcard_domain">
<span class="doc doc-object-name doc-function-name">is_wildcard_domain</span>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-async"><code>async</code></small>
</span>
</h2>
<div class="doc-signature highlight" style="background: #0d1117"><pre style="line-height: 125%;"><span></span><code><span style="color: #e6edf3">is_wildcard_domain(domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>bbot/core/helpers/dns/dns.py</code></summary>
<div class="highlight" style="background: #0d1117"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">159</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">160</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">161</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">162</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">163</span>
<span style="color: #6e7681; background-color: #0d1117; padding-left: 5px; padding-right: 5px;">164</span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><span style="color: #ff7b72">async</span> <span style="color: #ff7b72">def</span> <span style="color: #d2a8ff; font-weight: bold">is_wildcard_domain</span><span style="color: #e6edf3">(self,</span> <span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">):</span>
    <span style="color: #e6edf3">domain</span> <span style="color: #ff7b72; font-weight: bold">=</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">_wildcard_prevalidation(domain)</span>
    <span style="color: #ff7b72">if</span> <span style="color: #ff7b72; font-weight: bold">not</span> <span style="color: #e6edf3">domain:</span>
        <span style="color: #ff7b72">return</span> <span style="color: #e6edf3">{}</span>

    <span style="color: #ff7b72">return</span> <span style="color: #ff7b72">await</span> <span style="color: #e6edf3">self</span><span style="color: #ff7b72; font-weight: bold">.</span><span style="color: #e6edf3">run_and_return(</span><span style="color: #a5d6ff">"is_wildcard_domain"</span><span style="color: #e6edf3">,</span> <span style="color: #e6edf3">domain</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #e6edf3">domain,</span> <span style="color: #e6edf3">log_info</span><span style="color: #ff7b72; font-weight: bold">=</span><span style="color: #79c0ff">False</span><span style="color: #e6edf3">)</span>
</code></pre></div></td></tr></table></div>
</details>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.tooltips", "navigation.tabs", "navigation.sections", "navigation.expand", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.ad660dcc.min.js"></script>
<script src="../../../javascripts/tablesort.js"></script>
<script src="../../../javascripts/vega@5.js"></script>
<script src="../../../javascripts/vega-lite@5.js"></script>
<script src="../../../javascripts/vega-embed@6.js"></script>
<script src="../../../data/chord_graph/vega.json"></script>
</body>
</html>